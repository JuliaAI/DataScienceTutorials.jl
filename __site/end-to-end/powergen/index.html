<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
   <!-- Syntax highlighting via Prism, note: restricted langs -->
<link rel="stylesheet" href="/DataScienceTutorials.jl/libs/highlight/github.min.css">
 
  <link rel="stylesheet" href="/DataScienceTutorials.jl/css/franklin.css">
  <link rel="stylesheet" href="/DataScienceTutorials.jl/css/pure.css">
  <link rel="stylesheet" href="/DataScienceTutorials.jl/css/side-menu.css">
  <link rel="stylesheet" href="/DataScienceTutorials.jl/css/extra.css">
  <!-- <link rel="icon" href="/DataScienceTutorials.jl/assets/infra/favicon.gif"> -->
   <title>Power Generation</title>  
  <!-- LUNR -->
  <script src="/DataScienceTutorials.jl/libs/lunr/lunr.min.js"></script>
  <script src="/DataScienceTutorials.jl/libs/lunr/lunr_index.js"></script>
  <script src="/DataScienceTutorials.jl/libs/lunr/lunrclient.min.js"></script>
</head>
<body>
  <div id="layout">
    <!-- Menu toggle / hamburger icon -->
    <a href="#menu" id="menuLink" class="menu-link"><span></span></a>
    <div id="menu">
      <div class="pure-menu">
        <a href="/DataScienceTutorials.jl/" id="menu-logo-link">
          <div class="menu-logo">
            <!-- <img id="menu-logo" alt="MLJ Logo" src="/DataScienceTutorials.jl/assets/infra/MLJLogo2.svg" /> -->
            <p><strong>Data Science Tutorials</strong></p>
          </div>
        </a>
        <form id="lunrSearchForm" name="lunrSearchForm">
          <input class="search-input" name="q" placeholder="Enter search term" type="text">
          <input type="submit" value="Search" formaction="/DataScienceTutorials.jl/search/index.html" style="visibility:hidden">
        </form>
  <!-- LIST OF MENU ITEMS -->
  <ul class="pure-menu-list">
    <li class="pure-menu-item pure-menu-top-item "><a href="/DataScienceTutorials.jl/" class="pure-menu-link"><strong>Home</strong></a></li>

    <!-- DATA BASICS -->
    <li class="pure-menu-sublist-title"><strong>Data basics</strong></li>
    <ul class="pure-menu-sublist">
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/data/loading/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Loading data</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/data/dataframe/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Data Frames</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/data/categorical/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Categorical Arrays</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/data/scitype/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Scientific Type</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/data/processing/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Data processing</a></li>
    </ul>

    <!-- GETTING STARTED WITH MLJ -->
    <li class="pure-menu-sublist-title"><strong>Getting started</strong></li>
    <ul class="pure-menu-sublist">
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/getting-started/choosing-a-model/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Choosing a model</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/getting-started/fit-and-predict/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Fit, predict, transform</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/getting-started/model-tuning/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Model tuning</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/getting-started/ensembles/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Ensembles</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/getting-started/ensembles-2/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Ensembles (2)</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/getting-started/ensembles-3/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Ensembles (3)</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/getting-started/composing-models/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Composing models</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/getting-started/learning-networks/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Learning networks</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/getting-started/learning-networks-2/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Learning networks (2)</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/getting-started/stacking/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Stacking</a></li>
    </ul>

    <!-- INTRO TO STATS LEARNING -->
    <li class="pure-menu-sublist-title"><strong>Intro to Stats Learning</strong></li>
    <ul class="pure-menu-sublist" id=isl>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-2/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Lab 2</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-3/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Lab 3</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-4/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Lab 4</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-5/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Lab 5</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-6b/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Lab 6b</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-8/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Lab 8</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-9/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Lab 9</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-10/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Lab 10</a></li>
    </ul>

    <!-- END TO END EXAMPLES -->
    <li class="pure-menu-sublist-title"><strong>End to end examples</strong></li>
    <ul class="pure-menu-sublist" id=e2e>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/AMES/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> AMES</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/wine/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Wine</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/crabs-xgb/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Crabs (XGB)</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/horse/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Horse</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/HouseKingCounty/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> King County Houses</a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/airfoil" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Airfoil </a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/boston-lgbm" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Boston (lgbm) </a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/glm/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Using GLM.jl </a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/powergen/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Power Generation </a></li>
      <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/boston-flux" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Boston (Flux) </a></li>
    </ul>
  </ul>
  <!-- END OF LIST OF MENU ITEMS -->
      </div>
    </div>
    <div id="main"> <!-- Closed in foot -->
      

<!-- Content appended here -->
<div class="franklin-content"><h1 id="power_generation"><a href="#power_generation">Power Generation</a></h1>
<em>Download the</em> <a href="https://raw.githubusercontent.com/alan-turing-institute/DataScienceTutorials.jl/gh-pages/generated/notebooks/EX-powergen.ipynb" target="_blank"><em>notebook</em></a>, <em>the</em> <a href="https://raw.githubusercontent.com/alan-turing-institute/DataScienceTutorials.jl/gh-pages/generated/scripts/EX-powergen-raw.jl" target="_blank"><em>raw script</em></a>, <em>or the</em> <a href="https://raw.githubusercontent.com/alan-turing-institute/DataScienceTutorials.jl/gh-pages/generated/scripts/EX-powergen.jl" target="_blank"><em>annotated script</em></a> <em>for this tutorial &#40;right-click on the link and save&#41;.</em> <div class="franklin-toc"><ol><li><a href="#initial_data_processing">Initial data processing</a><ol><li><a href="#adjusting_the_scientific_types">Adjusting the scientific types</a></li></ol></li><li><a href="#exploratory_data_analysis">Exploratory Data Analysis</a></li><li><a href="#models">Models</a><ol><li><a href="#model_evaluation">Model evaluation</a></li></ol></li></ol></div><strong>Main author</strong>: <a href="https://github.com/gd1989">Geoffroy Dolphin</a></p>
<h2 id="initial_data_processing"><a href="#initial_data_processing">Initial data processing</a></h2>  In this tutorial we are fitting solar and wind power generation output for Germany using weather data. We focus on the use of a simple linear estimator. Let&#39;s load the required packages to get started.</p>
<pre><code class="language-julia">using MLJ
using UrlDownload
using PyPlot
import DataFrames: DataFrame, describe, names, select!
using Statistics

@load LinearRegressor pkg=MLJLinearModels</code></pre><pre><code class="plaintext">LinearRegressor(
    fit_intercept = true,
    solver = nothing) @926</code></pre>
<p>The power generation and weather data come from two separate datasets. We downloaded both datasets from <a href="https://open-power-system-data.org/">Open Power networks</a>. The power generation data is available <a href="https://data.open-power-system-data.org/time_series/">here</a> and the weather data is available <a href="https://data.open-power-system-data.org/weather_data/">here</a>. Note that the first row in both datasets contains headers; hence we don&#39;t need to provide any.</p>
<pre><code class="language-julia">data_repo = "https://raw.githubusercontent.com/tlienart/DataScienceTutorialsData.jl/master/data"

url_power   = data_repo * "/power_syst/DE_power_hourly.csv"
url_weather = data_repo * "/power_syst/DE_weather_data.csv"

power   = DataFrame(urldownload(url_power))
weather = DataFrame(urldownload(url_weather));</code></pre>
<p>We&#39;ve loaded both datasets but only have a rough idea of what&#39;s in each of them. Let&#39;s get a quick overview of the power dataset:</p>
<pre><code class="language-julia">describe(power, :mean, :nmissing)</code></pre><pre><code class="plaintext">18×3 DataFrame
│ Row │ variable                               │ mean      │ nmissing │
│     │ Symbol                                 │ Union…    │ Union…   │
├─────┼────────────────────────────────────────┼───────────┼──────────┤
│ 1   │ utc_timestamp                          │           │          │
│ 2   │ cet_cest_timestamp                     │           │          │
│ 3   │ DE_load_actual_entsoe_power_statistics │ 59050.7   │          │
│ 4   │ DE_load_actual_entsoe_transparency     │ 55062.6   │          │
│ 5   │ DE_load_forecast_entsoe_transparency   │ 54235.2   │ 48       │
│ 6   │ DE_price_day_ahead                     │ 29.1348   │ 1        │
│ 7   │ DE_solar_capacity                      │ 39560.4   │          │
│ 8   │ DE_solar_generation_actual             │ 3566.92   │          │
│ 9   │ DE_solar_profile                       │ 0.0901202 │          │
│ 10  │ DE_wind_capacity                       │ 45474.6   │          │
│ 11  │ DE_wind_generation_actual              │ 9684.06   │          │
│ 12  │ DE_wind_profile                        │ 0.214796  │          │
│ 13  │ DE_wind_offshore_capacity              │ 3624.74   │          │
│ 14  │ DE_wind_offshore_generation_actual     │ 1360.08   │ 1463     │
│ 15  │ DE_wind_offshore_profile               │ 0.371213  │ 1463     │
│ 16  │ DE_wind_onshore_capacity               │ 41849.9   │          │
│ 17  │ DE_wind_onshore_generation_actual      │ 8277.05   │          │
│ 18  │ DE_wind_onshore_profile                │ 0.199535  │          │</code></pre>
<p>and the weather dataset &#40;we only show the first 20 rows as there&#39;s 150 features&#41;:</p>
<pre><code class="language-julia">first(describe(weather, :mean, :nmissing), 20)</code></pre><pre><code class="plaintext">20×3 DataFrame
│ Row │ variable                          │ mean    │ nmissing │
│     │ Symbol                            │ Union…  │ Nothing  │
├─────┼───────────────────────────────────┼─────────┼──────────┤
│ 1   │ utc_timestamp                     │         │          │
│ 2   │ DE11_windspeed_10m                │ 3.64385 │          │
│ 3   │ DE11_temperature                  │ 8.74556 │          │
│ 4   │ DE11_radiation_direct_horizontal  │ 83.1536 │          │
│ 5   │ DE11_radiation_diffuse_horizontal │ 56.3569 │          │
│ 6   │ DE12_windspeed_10m                │ 3.58421 │          │
│ 7   │ DE12_temperature                  │ 9.34965 │          │
│ 8   │ DE12_radiation_direct_horizontal  │ 80.6525 │          │
│ 9   │ DE12_radiation_diffuse_horizontal │ 56.7742 │          │
│ 10  │ DE13_windspeed_10m                │ 2.80505 │          │
│ 11  │ DE13_temperature                  │ 8.2538  │          │
│ 12  │ DE13_radiation_direct_horizontal  │ 84.9794 │          │
│ 13  │ DE13_radiation_diffuse_horizontal │ 57.2333 │          │
│ 14  │ DE14_windspeed_10m                │ 3.26426 │          │
│ 15  │ DE14_temperature                  │ 8.092   │          │
│ 16  │ DE14_radiation_direct_horizontal  │ 84.4653 │          │
│ 17  │ DE14_radiation_diffuse_horizontal │ 57.6875 │          │
│ 18  │ DE21_windspeed_10m                │ 2.769   │          │
│ 19  │ DE21_temperature                  │ 8.1148  │          │
│ 20  │ DE21_radiation_direct_horizontal  │ 82.7924 │          │</code></pre>
<p>Let&#39;s first consider the columns of the power DataFrame. For the purpose of this tutorial we are only interested in actual wind and solar generation. So we select a subset of the power dataframe containing only <code>:utc_timestamp, :DE_solar_generation_actual</code> and <code>:DE_wind_generation_actual</code>:</p>
<pre><code class="language-julia">select!(power, [
    :utc_timestamp,
    :DE_solar_generation_actual,
    :DE_wind_generation_actual]);</code></pre>
<p>Inspection of the column names in the weather DataFrame shows that we have weather data at the regional level &#40;38 NUTS-2 statistical regions&#41;, which consists of four different weather variables: <code>_windspeed_10m, _temperature, _radiation_direct_horizontal, _radiation_diffuse_horizontal</code>. To match the structure of the power data, we need to aggregate at the country level. We do this by calculating the country-level average across all 38 regions, for each weather variable. This means we need to calculate an average across columns of the DataFrame that refer to the same weather variable. To do this we define a simple function to filter columns based on weather variable name and create new dataframes.</p>
<pre><code class="language-julia">colnames = names(weather)

filter_by_name(name, cols) =
    filter(cn -> occursin(name, String(cn)), cols)

wind   = weather[:, filter_by_name("windspeed", colnames)]
temp   = weather[:, filter_by_name("temperature", colnames)]
raddir = weather[:, filter_by_name("radiation_direct", colnames)]
raddif = weather[:, filter_by_name("radiation_diffuse", colnames)];</code></pre>
<p>Next, we create a new column in each DataFrame to store the country-level mean and calculate the mean. We use a nested loop. The lower level loop iterates over all rows of a given DataFrame, the higher-level loop iterates over all dataframes in the df Array.</p>
<pre><code class="language-julia">dfs = [wind, temp, raddir, raddif]
col_mean = [:windspeed_mean, :temp_mean, :raddir_mean, :raddif_mean];</code></pre>
<p>the zip function associates elements of two objects in the same position with one another:</p>
<pre><code class="language-julia">nrows = size(first(dfs), 1)
for (df, name) in zip(dfs, col_mean)
    df[!, name] = zeros(nrows)
    for (i, row) in enumerate(eachrow(df))
      df[i, name] = mean(row)
    end
end;</code></pre>
<p>Now that we have all variables we need to conduct our analysis, let&#39;s gather them in a single DataFrame...</p>
<pre><code class="language-julia">data = DataFrame(
    Timestamp     = weather.utc_timestamp,
    Solar_gen     = power.DE_solar_generation_actual,
    Wind_gen      = power.DE_wind_generation_actual,
    Windspeed     = wind.windspeed_mean,
    Temperature   = temp.temp_mean,
    Radiation_dir = raddir.raddir_mean,
    Radiation_dif = raddif.raddif_mean);</code></pre>
<p>...and have a look at their summary statistics</p>
<pre><code class="language-julia">describe(data, :mean, :median, :nmissing)</code></pre><pre><code class="plaintext">7×4 DataFrame
│ Row │ variable      │ mean    │ median  │ nmissing │
│     │ Symbol        │ Union…  │ Union…  │ Nothing  │
├─────┼───────────────┼─────────┼─────────┼──────────┤
│ 1   │ Timestamp     │         │         │          │
│ 2   │ Solar_gen     │ 3566.92 │ 53.0    │          │
│ 3   │ Wind_gen      │ 9684.06 │ 7754.0  │          │
│ 4   │ Windspeed     │ 4.04812 │ 3.65154 │          │
│ 5   │ Temperature   │ 8.57928 │ 7.32667 │          │
│ 6   │ Radiation_dir │ 74.0164 │ 0.1769  │          │
│ 7   │ Radiation_dif │ 54.1079 │ 2.00599 │          │</code></pre>
<p>Note that the <code>describe&#40;&#41;</code> function provides you with information about missing values for each of the columns. Fortunately, there are none.</p>
<h3 id="adjusting_the_scientific_types"><a href="#adjusting_the_scientific_types">Adjusting the scientific types</a></h3>
<p>Let&#39;s check the default scientific type that&#39;s currently associated with the data features:</p>
<pre><code class="language-julia">schema(data)</code></pre><pre><code class="plaintext">┌───────────────┬─────────┬────────────┐
│ _.names       │ _.types │ _.scitypes │
├───────────────┼─────────┼────────────┤
│ Timestamp     │ String  │ Textual    │
│ Solar_gen     │ Int64   │ Count      │
│ Wind_gen      │ Int64   │ Count      │
│ Windspeed     │ Float64 │ Continuous │
│ Temperature   │ Float64 │ Continuous │
│ Radiation_dir │ Float64 │ Continuous │
│ Radiation_dif │ Float64 │ Continuous │
└───────────────┴─────────┴────────────┘
_.nrows = 10247
</code></pre>
<p>It is important that the scientific type of the variables corresponds to one of the types allowed for use with the models you are planning to use. &#40;For more guidance on this, see the <a href="https://alan-turing-institute.github.io/DataScienceTutorials.jl/data/scitype/">Scientific Type</a> tutorial. The scientific type of both <code>Wind_gen</code> and <code>Solar_gen</code> is currently <code>Count</code>. Let&#39;s coerce them to <code>Continuous</code>.</p>
<pre><code class="language-julia">coerce!(data, :Wind_gen => Continuous)
coerce!(data, :Solar_gen => Continuous)

schema(data)</code></pre><pre><code class="plaintext">┌───────────────┬─────────┬────────────┐
│ _.names       │ _.types │ _.scitypes │
├───────────────┼─────────┼────────────┤
│ Timestamp     │ String  │ Textual    │
│ Solar_gen     │ Float64 │ Continuous │
│ Wind_gen      │ Float64 │ Continuous │
│ Windspeed     │ Float64 │ Continuous │
│ Temperature   │ Float64 │ Continuous │
│ Radiation_dir │ Float64 │ Continuous │
│ Radiation_dif │ Float64 │ Continuous │
└───────────────┴─────────┴────────────┘
_.nrows = 10247
</code></pre>
<p>We&#39;re now ready to go&#33;</p>
<h2 id="exploratory_data_analysis"><a href="#exploratory_data_analysis">Exploratory Data Analysis</a></h2>
<p>To get a better understanding of our targets, let&#39;s plot their respective distributions.</p>
<pre><code class="language-julia">figure(figsize=(8, 6))
hist(data.Solar_gen, color="blue", edgecolor="white", bins=100,
     density=true, alpha=0.5)
xlabel("Solar power generation (MWh)", fontsize=14)
ylabel("Frequency", fontsize=14)
xticks(fontsize=12)
yticks([0, 1e-3, 2e-3], fontsize=12)</code></pre>
<img src="/DataScienceTutorials.jl/assets/end-to-end/powergen/code/output/hist_solar.svg" alt="Histogram of the solar power generated">
<p>As one might expect, the sun doesn&#39;t always shine &#40;and certainly not at night&#41;, hence there is a very high proportion of observations whose value is equal or close to 0. The distribution of wind power generation looks markedly different</p>
<pre><code class="language-julia">figure(figsize=(8, 6))
hist(data.Wind_gen, color="blue", edgecolor = "white", bins=50,
     density=true, alpha=0.5)
xlabel("Wind power generation (MWh)", fontsize=14)
ylabel("Frequency", fontsize=14)</code></pre>
<img src="/DataScienceTutorials.jl/assets/end-to-end/powergen/code/output/hist_wind.svg" alt="Histogram of the wind power generated">
<p>Finally, before fitting the estimator, we might want to gauge what to expect from them by looking at scatter plots. Let&#39;s look at solar power first.</p>
<pre><code class="language-julia">fig = figure(figsize=(15, 15))

subplot(221)
scatter(data.Solar_gen, data.Radiation_dir)
xlabel("Solar power (kW)", fontsize=14)
ylabel("Solar radiation - directional", fontsize=14)

subplot(222)
scatter(data.Solar_gen, data.Radiation_dif)
xlabel("Solar power (kW)", fontsize=14)
ylabel("Solar radiation - diffuse", fontsize=14)

subplot(223)
scatter(data.Solar_gen, data.Windspeed)
xlabel("Solar power (kW)", fontsize=14)
ylabel("Wind speed (m/s)", fontsize=14)

subplot(224)
scatter(data.Solar_gen, data.Temperature)
xlabel("Solar power (kW)", fontsize=14)
ylabel("Temperature (C)", fontsize=14)</code></pre>
<div class="img-wide"><img src="/DataScienceTutorials.jl/assets/end-to-end/powergen/code/output/solar_scatter.png" alt="Solar power scatter plots"></div>
<p>Then at wind generation</p>
<pre><code class="language-julia">fig = figure(figsize=(15, 15))

subplot(221)
scatter(data.Wind_gen, data.Radiation_dir)
xlabel("Wind power (kW)", fontsize=14)
ylabel("Solar radiation - directional", fontsize=14)

subplot(222)
scatter(data.Wind_gen, data.Radiation_dif)
xlabel("Wind power (kW)", fontsize=14)
ylabel("Solar radiation - diffuse", fontsize=14)

subplot(223)
scatter(data.Wind_gen, data.Windspeed)
xlabel("Wind power (kW)", fontsize=14)
ylabel("Wind speed (m/s)", fontsize=14)

subplot(224)
scatter(data.Wind_gen, data.Temperature)
xlabel("Wind power (kW)", fontsize=14)
ylabel("Temperature (C)", fontsize=14)</code></pre>
<div class="img-wide"><img src="/DataScienceTutorials.jl/assets/end-to-end/powergen/code/output/wind_scatter.png" alt="Wind power scatter plots"></div>
<p>As expected, solar power generation shows a strong relationship to solar irradiance while wind power generation denotes a strong relationship to wind speed.</p>
<h2 id="models"><a href="#models">Models</a></h2>
<p>Let&#39;s fit a linear regression to our data. We focus on fitting the wind power generation but the same procedure could be applied for the solar power generation &#40;a good exercise&#33;&#41;.</p>
<pre><code class="language-julia">y_wind = data.Wind_gen
X = data[:, [:Windspeed, :Temperature, :Radiation_dir, :Radiation_dif]];</code></pre>
<p>Next, we partition the data in training and test set; we choose the usual 70-30 split:</p>
<pre><code class="language-julia">train, test = partition(eachindex(y_wind), 0.7, shuffle=true, rng=5);</code></pre>
<p>then we instantiate a model and fit it:</p>
<pre><code class="language-julia">linReg = LinearRegressor()
m_linReg = machine(linReg, X, y_wind)
fit!(m_linReg, rows=train);</code></pre>
<h3 id="model_evaluation"><a href="#model_evaluation">Model evaluation</a></h3>
<p>We&#39;ve now fitted the model for wind power generation &#40;<code>Wind_gen</code>&#41;. Let&#39;s use it to predict values over the test set and investigate the performance:</p>
<pre><code class="language-julia">y_hat = predict(m_linReg, rows=test);</code></pre>
<p>We can start by visualising the observed and predicted valzes of wind power generation.</p>
<pre><code class="language-julia">figure(figsize=(8, 6))
plot(y_hat, color="blue", label="Predicted")
plot(y_wind[test], color="red", label="Observed")
xlabel("Time", fontsize=14)
ylabel("Power generation", fontsize=14)
xticks([])
yticks(fontsize=12)
xlim(0, 100)
legend(fontsize=14)</code></pre>
<img src="/DataScienceTutorials.jl/assets/end-to-end/powergen/code/output/obs_v_pred.svg" alt="Observed vs Predicted">
<p>Let&#39;s look at the RMSE on the training and test sets.</p>
<pre><code class="language-julia">rms(y_wind[train], predict(m_linReg, rows=train))</code></pre><pre><code class="plaintext">2934.5999638857506</code></pre>
<p>on the test set...</p>
<pre><code class="language-julia">rms(y_wind[test], y_hat)</code></pre><pre><code class="plaintext">2872.517439095296</code></pre>
<p>Finally, let&#39;s plot the residuals to see if there is any obvious remaining structure in them.</p>
<pre><code class="language-julia">res = y_hat .- y_wind[test];</code></pre>
<p>Let&#39;s look at the stem plot of the residuals to check if there&#39;s any structure we might not have picked up:</p>
<pre><code class="language-julia">figure(figsize=(12, 6))
stem(res)
xlim(0, length(res))</code></pre>
<div class="img-wide"><img src="/DataScienceTutorials.jl/assets/end-to-end/powergen/code/output/residuals.png" alt="Residuals"></div>
<p>Nothing really stands out, the distribution also looks ok:</p>
<pre><code class="language-julia">figure(figsize=(8, 6))
hist(res, color="blue", edgecolor="white", bins=50,
     density=true, alpha=0.5)</code></pre>
<img src="/DataScienceTutorials.jl/assets/end-to-end/powergen/code/output/hist_residuals.svg" alt="Histogram of the residuals">
<p>We leave it at that for now, I hope you found this tutorial interesting.<div class="page-foot">
  <div class="copyright">
    &copy; Thibaut Lienart, Anthony Blaom, Sebastian Vollmer and collaborators. Last modified: July 14, 2020. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>.
  </div>
</div>
</div><!-- CONTENT ENDS HERE -->
      </div> <!-- end of id=main -->
  </div> <!-- end of id=layout -->
  <script src="/DataScienceTutorials.jl/libs/pure/ui.min.js"></script>
  
  
      <script src="/DataScienceTutorials.jl/libs/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>

  
</body>
</html>
