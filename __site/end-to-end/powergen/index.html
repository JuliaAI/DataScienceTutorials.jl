<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
   <!-- Syntax highlighting via Prism, note: restricted langs -->
<link rel="stylesheet" href="/libs/highlight/github.min.css">
 
  <link rel="stylesheet" href="/css/landing.css">
  <link rel="stylesheet" href="/css/franklin.css">
  <link rel="stylesheet" href="/css/pure.css">
  <link rel="stylesheet" href="/css/side-menu.css">
  <link rel="stylesheet" href="/css/nav.css">
  <link rel="stylesheet" href="/css/extra.css">
  <!-- <link rel="icon" href="/assets/infra/favicon.gif"> -->
   <title>Power Generation</title> 
  <!-- LUNR -->
  <script src="/libs/lunr/lunr.min.js"></script>
  <script src="/libs/lunr/lunr_index.js"></script>
  <script src="/libs/lunr/lunrclient.min.js"></script>
</head>

<body>
  <div id="layout">
    <!-- Menu toggle / hamburger icon -->
    <a href="#menu" id="menuLink" class="menu-link"><span></span></a>
    <div id="menu" style="display: none;">
      <div class="pure-menu">
        <a href="/" id="menu-logo-link">
          <div class="menu-logo">
            <!-- <img id="menu-logo" alt="MLJ Logo" src="/assets/infra/MLJLogo2.svg" /> -->
            <p><strong>Data Science Tutorials</strong></p>
          </div>
        </a>
        <form id="lunrSearchForm" name="lunrSearchForm">
          <input class="search-input" name="q" placeholder="Search in tutorials..." type="text">
          <input type="submit" value="Search" formaction="/search/index.html" style="display:none">
        </form>
        <!-- LIST OF MENU ITEMS -->
        <ul class="pure-menu-list">
          <li class="pure-menu-item pure-menu-top-item "><a href="/"
              class="pure-menu-link"><strong>Home</strong></a></li>

          <!-- DATA BASICS -->
          <div class="dropdown">
            <li class="pure-menu-sublist-title"><strong>Data Basics</strong></li>
          </div>
          <div class="collapse dropdown-content">
            <ul class="pure-menu-sublist">
              <li class="pure-menu-item "><a
                  href="/data/loading/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Loading
                  data</a></li>
              <li class="pure-menu-item "><a
                  href="/data/dataframe/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Data
                  Frames</a></li>
              <li class="pure-menu-item "><a
                  href="/data/categorical/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span>
                  Categorical Arrays</a></li>
              <li class="pure-menu-item "><a
                  href="/data/scitype/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Scientific
                  Type</a></li>
              <li class="pure-menu-item "><a
                  href="/data/processing/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Data
                  processing</a></li>
            </ul>
          </div>

          <!-- GETTING STARTED WITH MLJ -->
          <div class="dropdown">
            <li class="pure-menu-sublist-title"><strong>Getting Started</strong></li>
          </div>
          <div class="collapse dropdown-content">
            <ul class="pure-menu-sublist">
              <li
                class="pure-menu-item ">
                <a href="/getting-started/choosing-a-model/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Choosing a model</a>
              </li>
              <li class="pure-menu-item ">
                <a href="/getting-started/fit-and-predict/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Fit, predict, transform</a>
              </li>
              <li class="pure-menu-item "><a
                  href="/getting-started/model-tuning/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Model tuning</a></li>
              <li class="pure-menu-item "><a
                  href="/getting-started/ensembles/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span>
                  Ensembles</a></li>
              <li class="pure-menu-item "><a
                  href="/getting-started/ensembles-2/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Ensembles 2</a></li>
              <li
                class="pure-menu-item ">
                <a href="/getting-started/composing-models/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Composing models</a>
              </li>
              <li class="pure-menu-item "><a
                  href="/getting-started/stacking/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span>
                  Stacking</a></li>
            </ul>
          </div>
          <!-- INTRO TO STATS LEARNING -->
          <div class="dropdown">
            <li class="pure-menu-sublist-title"><strong>Intro to Stats Learning</strong></li>
          </div>
          <div class="collapse dropdown-content">
            <ul class="pure-menu-sublist" id=isl>
              <li class="pure-menu-item "><a href="/isl/lab-2/"
                  class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Lab 2</a></li>
              <li class="pure-menu-item "><a href="/isl/lab-3/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 3</a></li>
              <li class="pure-menu-item "><a href="/isl/lab-4/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 4</a></li>
              <li class="pure-menu-item "><a href="/isl/lab-5/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 5</a></li>
              <li class="pure-menu-item "><a href="/isl/lab-6b/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 6b</a></li>
              <li class="pure-menu-item "><a href="/isl/lab-8/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 8</a></li>
              <li class="pure-menu-item "><a href="/isl/lab-9/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 9</a></li>
              <li class="pure-menu-item "><a href="/isl/lab-10/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 10</a></li>
            </ul>
          </div>
          <!-- End to End -->
          <div class="dropdown">
            <li class="pure-menu-sublist-title"><strong>End to End</strong></li>
          </div>
          <div class="dropdown-content collapse">
            <ul class="pure-menu-sublist" >
              <li class="pure-menu-item "><a
                  href="/end-to-end/telco/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span>Telco
                  Churn</a></li>
              <li class="pure-menu-item "><a
                  href="/end-to-end/AMES/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> AMES</a>
              </li>
              <li class="pure-menu-item "><a href="/end-to-end/wine/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Wine</a></li>
              <li class="pure-menu-item "><a
                  href="/end-to-end/crabs-xgb/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span>
                  Crabs (XGB)</a></li>
              <li class="pure-menu-item "><a href="/end-to-end/horse/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Horse</a></li>
              <li class="pure-menu-item "><a href="/end-to-end/HouseKingCounty/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> King County Houses</a></li>
              <li class="pure-menu-item "><a href="/end-to-end/airfoil" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Airfoil </a></li>
              <li class="pure-menu-item "><a href="/end-to-end/boston-lgbm" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Boston (lgbm) </a></li>
              <li class="pure-menu-item "><a href="/end-to-end/glm/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Using GLM.jl </a></li>
              <li class="pure-menu-item "><a href="/end-to-end/powergen/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Power Generation </a></li>
              <li class="pure-menu-item "><a href="/end-to-end/boston-flux" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Boston (Flux) </a></li>
              <li class="pure-menu-item "><a href="/end-to-end/breastcancer" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Breast Cancer</a></li>
              <li class="pure-menu-item "><a href="/end-to-end/creditfraud" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Credit Fraud</a></li>
            </ul>
          </div>
          <!-- ADVANCED EXAMPLES -->
          <div class="dropdown">
            <li class="pure-menu-sublist-title"><strong>Advanced Examples</strong></li>
          </div>
          <div class="dropdown-content collapse">
            <ul class="pure-menu-sublist" id=adv>
              <li class="pure-menu-item "><a href="/advanced/ensembles-3/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Ensembles (3)</a></li>
            </ul>
          </div>
      </div>
      </ul>
      <!-- END OF LIST OF MENU ITEMS -->
    </div>
  </div>
  <div id="nav" class="navigation">
    <div class="nav-container">
      <div class="brand">
        <a href="/">DataScienceTutorials.jl</a>
      </div>
      <nav>
        <div class="nav-mobile"><a id="nav-toggle" href="#!"><span></span></a></div>
        <ul class="nav-list">
        <!-- horizontal navigation bar gets injected -->
        </ul>
      </nav>
    </div>
  </div>
  <div id="main"> <!-- Closed in foot -->
    

    <!-- Content appended here --><div class="franklin-content"><h1 id="power_generation"><a href="#power_generation" class="header-anchor">Power Generation</a></h1>
<em>To ensure code in this tutorial runs as shown, download the tutorial <a href="https://raw.githubusercontent.com/juliaai/DataScienceTutorials.jl/gh-pages/__generated/EX-powergen.tar.gz">project folder</a> and follow <a href="/#learning_by_doing">these instructions</a>.</em></p>
<p><em>If you have questions or suggestions about this tutorial, please open an issue <a href="https://github.com/JuliaAI/DataScienceTutorials.jl/issues/new">here</a>.</em></p>
<p><div class="franklin-toc"><ol><li><a href="#initial_data_processing">Initial data processing</a><ol><li><a href="#adjusting_the_scientific_types">Adjusting the scientific types</a></li></ol></li><li><a href="#exploratory_data_analysis">Exploratory Data Analysis</a></li><li><a href="#models">Models</a><ol><li><a href="#model_evaluation">Model evaluation</a></li></ol></li></ol></div>
<p><strong>Main author</strong>: <a href="https://github.com/gd1989">Geoffroy Dolphin</a></p>
<div class="dropdown"><h2 id="initial_data_processing"><a href="#initial_data_processing" class="header-anchor">Initial data processing</a></h2></div>
<div class="dropdown-content"><p>In this tutorial we are fitting solar and wind power generation output for Germany using weather data. We focus on the use of a simple linear estimator. Let&#39;s load the required packages to get started.</p>
<pre><code class="language-julia">using MLJ
using UrlDownload
import DataFrames: DataFrame, describe, names, select&#33;
using Statistics

LinearRegressor &#61; @load LinearRegressor pkg &#61; MLJLinearModels</code></pre><pre><code class="plaintext code-output">import MLJLinearModels ✔
MLJLinearModels.LinearRegressor</code></pre>
<p>The power generation and weather data come from two separate datasets. We downloaded both datasets from <a href="https://open-power-system-data.org/">Open Power networks</a>. The power generation data is available <a href="https://data.open-power-system-data.org/time_series/">here</a> and the weather data is available <a href="https://data.open-power-system-data.org/weather_data/">here</a>. Note that the first row in both datasets contains headers; hence we don&#39;t need to provide any.</p>
<pre><code class="language-julia">data_repo &#61; &quot;https://raw.githubusercontent.com/tlienart/DataScienceTutorialsData.jl/master/data&quot;

url_power   &#61; data_repo * &quot;/power_syst/DE_power_hourly.csv&quot;
url_weather &#61; data_repo * &quot;/power_syst/DE_weather_data.csv&quot;

power &#61; DataFrame&#40;urldownload&#40;url_power&#41;&#41;
weather &#61; DataFrame&#40;urldownload&#40;url_weather&#41;&#41;;</code></pre>
<p>We&#39;ve loaded both datasets but only have a rough idea of what&#39;s in each of them. Let&#39;s get a quick overview of the power dataset:</p>
<pre><code class="language-julia">describe&#40;power, :mean, :nmissing&#41;</code></pre><pre><code class="plaintext code-output">18×3 DataFrame
 Row │ variable                           mean       nmissing
     │ Symbol                             Union…     Int64
─────┼────────────────────────────────────────────────────────
   1 │ utc_timestamp                                        0
   2 │ cet_cest_timestamp                                   0
   3 │ DE_load_actual_entsoe_power_stat…  59050.7           0
   4 │ DE_load_actual_entsoe_transparen…  55062.6           0
   5 │ DE_load_forecast_entsoe_transpar…  54235.2          48
   6 │ DE_price_day_ahead                 29.1348           1
   7 │ DE_solar_capacity                  39560.4           0
   8 │ DE_solar_generation_actual         3566.92           0
   9 │ DE_solar_profile                   0.0901202         0
  10 │ DE_wind_capacity                   45474.6           0
  11 │ DE_wind_generation_actual          9684.06           0
  12 │ DE_wind_profile                    0.214796          0
  13 │ DE_wind_offshore_capacity          3624.74           0
  14 │ DE_wind_offshore_generation_actu…  1360.08        1463
  15 │ DE_wind_offshore_profile           0.371213       1463
  16 │ DE_wind_onshore_capacity           41849.9           0
  17 │ DE_wind_onshore_generation_actual  8277.05           0
  18 │ DE_wind_onshore_profile            0.199535          0</code></pre>
<p>and the weather dataset &#40;we only show the first 20 rows as there&#39;s 150 features&#41;:</p>
<pre><code class="language-julia">first&#40;describe&#40;weather, :mean, :nmissing&#41;, 20&#41;</code></pre><pre><code class="plaintext code-output">20×3 DataFrame
 Row │ variable                           mean     nmissing
     │ Symbol                             Union…   Int64
─────┼──────────────────────────────────────────────────────
   1 │ utc_timestamp                                      0
   2 │ DE11_windspeed_10m                 3.64385         0
   3 │ DE11_temperature                   8.74556         0
   4 │ DE11_radiation_direct_horizontal   83.1536         0
   5 │ DE11_radiation_diffuse_horizontal  56.3569         0
   6 │ DE12_windspeed_10m                 3.58421         0
   7 │ DE12_temperature                   9.34965         0
   8 │ DE12_radiation_direct_horizontal   80.6525         0
   9 │ DE12_radiation_diffuse_horizontal  56.7742         0
  10 │ DE13_windspeed_10m                 2.80505         0
  11 │ DE13_temperature                   8.2538          0
  12 │ DE13_radiation_direct_horizontal   84.9794         0
  13 │ DE13_radiation_diffuse_horizontal  57.2333         0
  14 │ DE14_windspeed_10m                 3.26426         0
  15 │ DE14_temperature                   8.092           0
  16 │ DE14_radiation_direct_horizontal   84.4653         0
  17 │ DE14_radiation_diffuse_horizontal  57.6875         0
  18 │ DE21_windspeed_10m                 2.769           0
  19 │ DE21_temperature                   8.1148          0
  20 │ DE21_radiation_direct_horizontal   82.7924         0</code></pre>
<p>Let&#39;s first consider the columns of the power DataFrame. For the purpose of this tutorial we are only interested in actual wind and solar generation. So we select a subset of the power dataframe containing only <code>:utc_timestamp, :DE_solar_generation_actual</code> and <code>:DE_wind_generation_actual</code>:</p>
<pre><code class="language-julia">select&#33;&#40;power, &#91;
	:utc_timestamp,
	:DE_solar_generation_actual,
	:DE_wind_generation_actual&#93;&#41;;</code></pre>
<p>Inspection of the column names in the weather DataFrame shows that we have weather data at the regional level &#40;38 NUTS-2 statistical regions&#41;, which consists of four different weather variables: <code>_windspeed_10m, _temperature, _radiation_direct_horizontal, _radiation_diffuse_horizontal</code>. To match the structure of the power data, we need to aggregate at the country level. We do this by calculating the country-level average across all 38 regions, for each weather variable. This means we need to calculate an average across columns of the DataFrame that refer to the same weather variable. To do this we define a simple function to filter columns based on weather variable name and create new dataframes.</p>
<pre><code class="language-julia">colnames &#61; names&#40;weather&#41;

filter_by_name&#40;name, cols&#41; &#61;
	filter&#40;cn -&gt; occursin&#40;name, String&#40;cn&#41;&#41;, cols&#41;

wind   &#61; weather&#91;:, filter_by_name&#40;&quot;windspeed&quot;, colnames&#41;&#93;
temp   &#61; weather&#91;:, filter_by_name&#40;&quot;temperature&quot;, colnames&#41;&#93;
raddir &#61; weather&#91;:, filter_by_name&#40;&quot;radiation_direct&quot;, colnames&#41;&#93;
raddif &#61; weather&#91;:, filter_by_name&#40;&quot;radiation_diffuse&quot;, colnames&#41;&#93;;</code></pre>
<p>Next, we create a new column in each DataFrame to store the country-level mean and calculate the mean. We use a nested loop. The lower level loop iterates over all rows of a given DataFrame, the higher-level loop iterates over all dataframes in the df Array.</p>
<pre><code class="language-julia">dfs &#61; &#91;wind, temp, raddir, raddif&#93;
col_mean &#61; &#91;:windspeed_mean, :temp_mean, :raddir_mean, :raddif_mean&#93;;</code></pre>
<p>the zip function associates elements of two objects in the same position with one another:</p>
<pre><code class="language-julia">n_rows &#61; size&#40;first&#40;dfs&#41;, 1&#41;
for &#40;df, name&#41; in zip&#40;dfs, col_mean&#41;
	df&#91;&#33;, name&#93; &#61; zeros&#40;n_rows&#41;
	for &#40;i, row&#41; in enumerate&#40;eachrow&#40;df&#41;&#41;
		df&#91;i, name&#93; &#61; mean&#40;row&#41;
	end
end;</code></pre>
<p>Now that we have all variables we need to conduct our analysis, let&#39;s gather them in a single DataFrame...</p>
<pre><code class="language-julia">data &#61; DataFrame&#40;
	Timestamp     &#61; weather.utc_timestamp,
	Solar_gen     &#61; power.DE_solar_generation_actual,
	Wind_gen      &#61; power.DE_wind_generation_actual,
	Windspeed     &#61; wind.windspeed_mean,
	Temperature   &#61; temp.temp_mean,
	Radiation_dir &#61; raddir.raddir_mean,
	Radiation_dif &#61; raddif.raddif_mean&#41;;</code></pre>
<p>...and have a look at their summary statistics</p>
<pre><code class="language-julia">describe&#40;data, :mean, :median, :nmissing&#41;</code></pre><pre><code class="plaintext code-output">7×4 DataFrame
 Row │ variable       mean     median   nmissing
     │ Symbol         Union…   Union…   Int64
─────┼───────────────────────────────────────────
   1 │ Timestamp                               0
   2 │ Solar_gen      3566.92  53.0            0
   3 │ Wind_gen       9684.06  7754.0          0
   4 │ Windspeed      4.04812  3.65154         0
   5 │ Temperature    8.57928  7.32667         0
   6 │ Radiation_dir  74.0164  0.1769          0
   7 │ Radiation_dif  54.1079  2.00599         0</code></pre>
<p>Note that the <code>describe&#40;&#41;</code> function provides you with information about missing values for each of the columns. Fortunately, there are none.</p>
<div class="dropdown"><h3 id="adjusting_the_scientific_types"><a href="#adjusting_the_scientific_types" class="header-anchor">Adjusting the scientific types</a></h3></div>
<div class="dropdown-content"><p>Let&#39;s check the default scientific type that&#39;s currently associated with the data features:</p>
<pre><code class="language-julia">schema&#40;data&#41;</code></pre><pre><code class="plaintext code-output">┌───────────────┬────────────┬──────────┐
│ names         │ scitypes   │ types    │
├───────────────┼────────────┼──────────┤
│ Timestamp     │ Textual    │ String31 │
│ Solar_gen     │ Count      │ Int64    │
│ Wind_gen      │ Count      │ Int64    │
│ Windspeed     │ Continuous │ Float64  │
│ Temperature   │ Continuous │ Float64  │
│ Radiation_dir │ Continuous │ Float64  │
│ Radiation_dif │ Continuous │ Float64  │
└───────────────┴────────────┴──────────┘
</code></pre>
<p>It is important that the scientific type of the variables corresponds to one of the types allowed for use with the models you are planning to use. &#40;For more guidance on this, see the <a href="https://alan-turing-institute.github.io/DataScienceTutorials.jl/data/scitype/">Scientific Type</a> tutorial. The scientific type of both <code>Wind_gen</code> and <code>Solar_gen</code> is currently <code>Count</code>. Let&#39;s coerce them to <code>Continuous</code>.</p>
<pre><code class="language-julia">coerce&#33;&#40;data, :Wind_gen &#61;&gt; Continuous&#41;
coerce&#33;&#40;data, :Solar_gen &#61;&gt; Continuous&#41;

schema&#40;data&#41;</code></pre><pre><code class="plaintext code-output">┌───────────────┬────────────┬──────────┐
│ names         │ scitypes   │ types    │
├───────────────┼────────────┼──────────┤
│ Timestamp     │ Textual    │ String31 │
│ Solar_gen     │ Continuous │ Float64  │
│ Wind_gen      │ Continuous │ Float64  │
│ Windspeed     │ Continuous │ Float64  │
│ Temperature   │ Continuous │ Float64  │
│ Radiation_dir │ Continuous │ Float64  │
│ Radiation_dif │ Continuous │ Float64  │
└───────────────┴────────────┴──────────┘
</code></pre>
<p>We&#39;re now ready to go&#33;</p>
<p>‎</p></div>
<p>‎</p></div>
<div class="dropdown"><h2 id="exploratory_data_analysis"><a href="#exploratory_data_analysis" class="header-anchor">Exploratory Data Analysis</a></h2></div>
<div class="dropdown-content"><p>To get a better understanding of our targets, let&#39;s plot their respective distributions.</p>
<pre><code class="language-julia">using Plots

histogram&#40;
	data.Solar_gen,
	color &#61; &quot;blue&quot;,
	bins &#61; 100,
	normalize &#61; :pdf,
	alpha &#61; 0.5,
	yticks &#61; &#91;0, 1e-3, 2e-3&#93;,
&#41;
xlabel&#33;&#40;&quot;Solar power generation &#40;MWh&#41;&quot;&#41;
ylabel&#33;&#40;&quot;Frequency&quot;&#41;</code></pre>
<img src="/assets/end-to-end/powergen/code/output/hist_solar.svg" alt="Histogram of the solar power generated">
<p>As one might expect, the sun doesn&#39;t always shine &#40;and certainly not at night&#41;, hence there is a very high proportion of observations whose value is equal or close to 0. The distribution of wind power generation looks markedly different</p>
<pre><code class="language-julia">histogram&#40;data.Wind_gen, color &#61; &quot;blue&quot;, bins &#61; 50, normalize &#61; :pdf, alpha &#61; 0.5&#41;
xlabel&#33;&#40;&quot;Wind power generation &#40;MWh&#41;&quot;&#41;
ylabel&#33;&#40;&quot;Frequency&quot;&#41;</code></pre>
<img src="/assets/end-to-end/powergen/code/output/hist_wind.svg" alt="Histogram of the wind power generated">
<p>Finally, before fitting the estimator, we might want to gauge what to expect from them by looking at scatter plots. Let&#39;s look at solar power first.</p>
<pre><code class="language-julia">p1 &#61; scatter&#40;
	data.Solar_gen,
	data.Radiation_dir,
	size &#61; &#40;150, 150&#41;,
	legend &#61; false,
	xlabel &#61; &quot;Solar power &#40;kW&#41;&quot;,
	ylabel &#61; &quot;Solar radiation - directional&quot;,
&#41;

p2 &#61; scatter&#40;
	data.Solar_gen,
	data.Radiation_dif,
	size &#61; &#40;150, 150&#41;,
	legend &#61; false,
	xlabel &#61; &quot;Solar power &#40;kW&#41;&quot;,
	ylabel &#61; &quot;Solar radiation - diffuse&quot;,
&#41;

p3 &#61; scatter&#40;
	data.Solar_gen,
	data.Windspeed,
	size &#61; &#40;150, 150&#41;,
	legend &#61; false,
	xlabel &#61; &quot;Solar power &#40;kW&#41;&quot;,
	ylabel &#61; &quot;Wind speed &#40;m/s&#41;&quot;,
&#41;

p4 &#61; scatter&#40;
	data.Solar_gen,
	data.Temperature,
	size &#61; &#40;150, 150&#41;,
	legend &#61; false,
	xlabel &#61; &quot;Solar power &#40;kW&#41;&quot;,
	ylabel &#61; &quot;Temperature &#40;C&#41;&quot;,
&#41;

plot&#33;&#40;p1, p2, p3, p4, layout &#61; &#40;2, 2&#41;, size &#61; &#40;1000, 1000&#41;&#41;</code></pre>
<div class="img-wide"><img src="/assets/end-to-end/powergen/code/output/solar_scatter.png" alt="Solar power scatter plots"></div>
<p>Then at wind generation</p>
<pre><code class="language-julia">p1 &#61; scatter&#40;
	data.Wind_gen,
	data.Radiation_dir,
	size &#61; &#40;150, 150&#41;,
	legend &#61; false,
	xlabel &#61; &quot;Solar power &#40;kW&#41;&quot;,
	ylabel &#61; &quot;Solar radiation - directional&quot;,
&#41;

p2 &#61; scatter&#40;
	data.Wind_gen,
	data.Radiation_dif,
	size &#61; &#40;150, 150&#41;,
	legend &#61; false,
	xlabel &#61; &quot;Solar power &#40;kW&#41;&quot;,
	ylabel &#61; &quot;Solar radiation - diffuse&quot;,
&#41;

p3 &#61; scatter&#40;
	data.Wind_gen,
	data.Windspeed,
	size &#61; &#40;150, 150&#41;,
	legend &#61; false,
	xlabel &#61; &quot;Solar power &#40;kW&#41;&quot;,
	ylabel &#61; &quot;Wind speed &#40;m/s&#41;&quot;,
&#41;

p4 &#61; scatter&#40;
	data.Wind_gen,
	data.Temperature,
	size &#61; &#40;150, 150&#41;,
	legend &#61; false,
	xlabel &#61; &quot;Solar power &#40;kW&#41;&quot;,
	ylabel &#61; &quot;Temperature &#40;C&#41;&quot;,
&#41;

plot&#33;&#40;p1, p2, p3, p4, layout &#61; &#40;2, 2&#41;, size &#61; &#40;1000, 1000&#41;&#41;</code></pre>
<div class="img-wide"><img src="/assets/end-to-end/powergen/code/output/wind_scatter.png" alt="Wind power scatter plots"></div>
<p>As expected, solar power generation shows a strong relationship to solar irradiance while wind power generation denotes a strong relationship to wind speed.</p>
<p>‎</p></div>
<div class="dropdown"><h2 id="models"><a href="#models" class="header-anchor">Models</a></h2></div>
<div class="dropdown-content"><p>Let&#39;s fit a linear regression to our data. We focus on fitting the wind power generation but the same procedure could be applied for the solar power generation &#40;a good exercise&#33;&#41;.</p>
<pre><code class="language-julia">y_wind &#61; data.Wind_gen
X &#61; data&#91;:, &#91;:Windspeed, :Temperature, :Radiation_dir, :Radiation_dif&#93;&#93;;</code></pre>
<p>Next, we partition the data in training and test set; we choose the usual 70-30 split:</p>
<pre><code class="language-julia">train, test &#61; partition&#40;collect&#40;eachindex&#40;y_wind&#41;&#41;, 0.7, shuffle &#61; true, rng &#61; 5&#41;;</code></pre>
<p>then we instantiate a model and fit it:</p>
<pre><code class="language-julia">linReg &#61; LinearRegressor&#40;&#41;
m_linReg &#61; machine&#40;linReg, X, y_wind&#41;
fit&#33;&#40;m_linReg, rows &#61; train&#41;;</code></pre>
<div class="dropdown"><h3 id="model_evaluation"><a href="#model_evaluation" class="header-anchor">Model evaluation</a></h3></div>
<div class="dropdown-content"><p>We&#39;ve now fitted the model for wind power generation &#40;<code>Wind_gen</code>&#41;. Let&#39;s use it to predict values over the test set and investigate the performance:</p>
<pre><code class="language-julia">y_hat &#61; MLJ.predict&#40;m_linReg, rows &#61; test&#41;;</code></pre>
<p>We can start by visualising the observed and predicted valzes of wind power generation.</p>
<pre><code class="language-julia">plot&#40;y_hat, color &#61; &quot;blue&quot;, label &#61; &quot;Predicted&quot;, xlim &#61; &#40;0, 100&#41;, xticks &#61; &#91;&#93;&#41;
plot&#33;&#40;y_wind&#91;test&#93;, color &#61; &quot;red&quot;, label &#61; &quot;Observed&quot;&#41;
xlabel&#33;&#40;&quot;Time&quot;&#41;
ylabel&#33;&#40;&quot;Power generation&quot;&#41;</code></pre>
<img src="/assets/end-to-end/powergen/code/output/obs_v_pred.svg" alt="Observed vs Predicted">
<p>Let&#39;s look at the RMSE on the training and test sets.</p>
<pre><code class="language-julia">rms&#40;y_wind&#91;train&#93;, MLJ.predict&#40;m_linReg, rows &#61; train&#41;&#41;</code></pre><pre><code class="plaintext code-output">2934.599963885754</code></pre>
<p>on the test set...</p>
<pre><code class="language-julia">rms&#40;y_wind&#91;test&#93;, y_hat&#41;</code></pre><pre><code class="plaintext code-output">2872.517439095293</code></pre>
<p>Finally, let&#39;s plot the residuals to see if there is any obvious remaining structure in them.</p>
<pre><code class="language-julia">res &#61; y_hat .- y_wind&#91;test&#93;;</code></pre>
<p>Let&#39;s look at the stem plot of the residuals to check if there&#39;s any structure we might not have picked up:</p>
<pre><code class="language-julia">plot&#40;res, line &#61; :stem, marker &#61; :circle, xlim &#61; &#40;0, length&#40;res&#41;&#41;&#41;
hline&#33;&#40;&#91;0&#93;, color &#61; &quot;red&quot;, linewidth &#61; 3&#41;</code></pre>
<img src="/assets/end-to-end/powergen/code/output/residuals.png" alt="Residuals"></div>
<p>Nothing really stands out, the distribution also looks ok:</p>
<pre><code class="language-julia">histogram&#40;res, color &#61; &quot;blue&quot;, bins &#61; 50, normalize &#61; :pdf, alpha &#61; 0.5, legend &#61; false&#41;</code></pre>
<img src="/assets/end-to-end/powergen/code/output/hist_residuals.svg" alt="Histogram of the residuals">
<p>We leave it at that for now, I hope you found this tutorial interesting.</p>
<p>‎</p></div>
<p>‎ @@</p>

<div class="bottom-nav-container">
  <a id="prev-tutorial" style="text-decoration: none"><Button class="bottom-nav">
        <div>← Previous Tutorial</div>
        <div id="prev-label" class="button-label"> Home</div>
    </Button></a>
  <a id="next-tutorial" style="text-decoration: none"><Button class="bottom-nav">
        <div>Next Tutorial →</div>
        <div id="next-label" class="button-label">Home</div> 
    </Button></a>
</div>
<div class="page-foot">
  <div class="copyright">
    &copy; Thibaut Lienart, Anthony Blaom, Sebastian Vollmer and collaborators. Last modified: April 02, 2024. Website built with <a
      href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>.
  </div>
</div></div><!-- CONTENT ENDS HERE -->
</div> <!-- end of id=main -->
</div> <!-- end of id=layout -->
<!-- for collapse functionality -->
<script src="/libs/collapse/collapse.js"></script>
<script src="/libs/pure/ui.min.js"></script>
<!-- head and footer-nav -->
<script src="/libs/nav/head.js"></script>
<script src="/libs/nav/footer-nav.js"></script>
<!-- landing page -->
<script src="/libs/landing/landing.js"></script>
<!-- navigation bar -->
<script src="/libs/nav/nav.js"></script>
<!-- responsive navigation bar -->
<script src="/libs/nav/responsive.js"></script>


<script src="/libs/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>


</body>

</html>