<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
   <!-- Syntax highlighting via Prism, note: restricted langs -->
<link rel="stylesheet" href="/DataScienceTutorials.jl/libs/highlight/github.min.css">
 
  <link rel="stylesheet" href="/DataScienceTutorials.jl/css/landing.css">
  <link rel="stylesheet" href="/DataScienceTutorials.jl/css/franklin.css">
  <link rel="stylesheet" href="/DataScienceTutorials.jl/css/pure.css">
  <link rel="stylesheet" href="/DataScienceTutorials.jl/css/side-menu.css">
  <link rel="stylesheet" href="/DataScienceTutorials.jl/css/nav.css">
  <link rel="stylesheet" href="/DataScienceTutorials.jl/css/extra.css">
  <!-- <link rel="icon" href="/DataScienceTutorials.jl/assets/infra/favicon.gif"> -->
   <title>Boston with LightGBM</title> 
  <!-- LUNR -->
  <script src="/DataScienceTutorials.jl/libs/lunr/lunr.min.js"></script>
  <script src="/DataScienceTutorials.jl/libs/lunr/lunr_index.js"></script>
  <script src="/DataScienceTutorials.jl/libs/lunr/lunrclient.min.js"></script>
</head>

<body>
  <div id="layout">
    <!-- Menu toggle / hamburger icon -->
    <a href="#menu" id="menuLink" class="menu-link"><span></span></a>
    <div id="menu" style="display: none;">
      <div class="pure-menu">
        <a href="/DataScienceTutorials.jl/" id="menu-logo-link">
          <div class="menu-logo">
            <!-- <img id="menu-logo" alt="MLJ Logo" src="/DataScienceTutorials.jl/assets/infra/MLJLogo2.svg" /> -->
            <p><strong>Data Science Tutorials</strong></p>
          </div>
        </a>
        <form id="lunrSearchForm" name="lunrSearchForm">
          <input class="search-input" name="q" placeholder="Search in tutorials..." type="text">
          <input type="submit" value="Search" formaction="/DataScienceTutorials.jl/search/index.html" style="display:none">
        </form>
        <!-- LIST OF MENU ITEMS -->
        <ul class="pure-menu-list">
          <li class="pure-menu-item pure-menu-top-item "><a href="/DataScienceTutorials.jl/"
              class="pure-menu-link"><strong>Home</strong></a></li>

          <!-- DATA BASICS -->
          <div class="dropdown">
            <li class="pure-menu-sublist-title"><strong>Data Basics</strong></li>
          </div>
          <div class="collapse dropdown-content">
            <ul class="pure-menu-sublist">
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/data/loading/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Loading
                  data</a></li>
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/data/dataframe/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Data
                  Frames</a></li>
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/data/categorical/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span>
                  Categorical Arrays</a></li>
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/data/scitype/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Scientific
                  Type</a></li>
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/data/processing/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Data
                  processing</a></li>
            </ul>
          </div>

          <!-- GETTING STARTED WITH MLJ -->
          <div class="dropdown">
            <li class="pure-menu-sublist-title"><strong>Getting Started</strong></li>
          </div>
          <div class="collapse dropdown-content">
            <ul class="pure-menu-sublist">
              <li
                class="pure-menu-item ">
                <a href="/DataScienceTutorials.jl/getting-started/choosing-a-model/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Choosing a model</a>
              </li>
              <li class="pure-menu-item ">
                <a href="/DataScienceTutorials.jl/getting-started/fit-and-predict/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Fit, predict, transform</a>
              </li>
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/getting-started/model-tuning/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Model tuning</a></li>
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/getting-started/ensembles/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span>
                  Ensembles</a></li>
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/getting-started/ensembles-2/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Ensembles 2</a></li>
              <li
                class="pure-menu-item ">
                <a href="/DataScienceTutorials.jl/getting-started/composing-models/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Composing models</a>
              </li>
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/getting-started/stacking/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span>
                  Stacking</a></li>
            </ul>
          </div>
          <!-- INTRO TO STATS LEARNING -->
          <div class="dropdown">
            <li class="pure-menu-sublist-title"><strong>Intro to Stats Learning</strong></li>
          </div>
          <div class="collapse dropdown-content">
            <ul class="pure-menu-sublist" id=isl>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-2/"
                  class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Lab 2</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-3/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 3</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-4/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 4</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-5/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 5</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-6b/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 6b</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-8/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 8</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-9/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 9</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-10/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 10</a></li>
            </ul>
          </div>
          <!-- End to End -->
          <div class="dropdown">
            <li class="pure-menu-sublist-title"><strong>End to End</strong></li>
          </div>
          <div class="dropdown-content collapse">
            <ul class="pure-menu-sublist" >
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/end-to-end/telco/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span>Telco
                  Churn</a></li>
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/end-to-end/AMES/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> AMES</a>
              </li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/wine/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Wine</a></li>
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/end-to-end/crabs-xgb/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span>
                  Crabs (XGB)</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/horse/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Horse</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/HouseKingCounty/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> King County Houses</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/airfoil" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Airfoil </a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/boston-lgbm" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Boston (lgbm) </a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/glm/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Using GLM.jl </a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/powergen/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Power Generation </a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/boston-flux" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Boston (Flux) </a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/breastcancer" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Breast Cancer</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/creditfraud" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Credit Fraud</a></li>
            </ul>
          </div>
          <!-- ADVANCED EXAMPLES -->
          <div class="dropdown">
            <li class="pure-menu-sublist-title"><strong>Advanced Examples</strong></li>
          </div>
          <div class="dropdown-content collapse">
            <ul class="pure-menu-sublist" id=adv>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/advanced/ensembles-3/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Ensembles (3)</a></li>
            </ul>
          </div>
      </div>
      </ul>
      <!-- END OF LIST OF MENU ITEMS -->
    </div>
  </div>
  <div id="nav" class="navigation">
    <div class="nav-container">
      <div class="brand">
        <a href="/DataScienceTutorials.jl/">DataScienceTutorials.jl</a>
      </div>
      <nav>
        <div class="nav-mobile"><a id="nav-toggle" href="#!"><span></span></a></div>
        <ul class="nav-list">
        <!-- horizontal navigation bar gets injected -->
        </ul>
      </nav>
    </div>
  </div>
  <div id="main"> <!-- Closed in foot -->
    

    <!-- Content appended here --><div class="franklin-content"><h1 id="boston_with_lightgbm"><a href="#boston_with_lightgbm" class="header-anchor">Boston with LightGBM</a></h1>
<em>To ensure code in this tutorial runs as shown, download the tutorial <a href="https://raw.githubusercontent.com/juliaai/DataScienceTutorials.jl/gh-pages/__generated/end-to-end/boston-lgbm.tar.gz">project folder</a> and follow <a href="/DataScienceTutorials.jl/#learning_by_doing">these instructions</a>.</em></p>
<p><em>If you have questions or suggestions about this tutorial, please open an issue <a href="https://github.com/JuliaAI/DataScienceTutorials.jl/issues/new">here</a>.</em></p>
<p><div class="franklin-toc"><ol><li><a href="#getting_started">Getting started</a></li></ol></div>
<p><strong>Main author</strong>: Yaqub Alwan &#40;IQVIA&#41;.</p>
<div class="dropdown"><h2 id="getting_started"><a href="#getting_started" class="header-anchor">Getting started</a></h2></div>
<div class="dropdown-content"><pre><code class="language-julia">using MLJ
import DataFrames
import Statistics
import StableRNGs.StableRNG

LGBMRegressor &#61; @load LGBMRegressor pkg&#61;LightGBM</code></pre><pre><code class="plaintext code-output">import LightGBMInitError: LightGBM.LibraryNotFoundError("lib_lightgbm not found. Please ensure this library is either in system dirs or the dedicated paths: [\"/Users/essam/.julia/packages/LightGBM/mUQGf/src\"]")
during initialization of module LightGBM
</code></pre>
<p>Let us try LightGBM out by doing a regression task on the Boston house prices dataset. This is a commonly used dataset so there is a loader built into MLJ.</p>
<p>Here, the objective is to show how LightGBM can do better than a Linear Regressor with minimal effort.</p>
<p>We start out by taking a quick peek at the data itself and its statistical properties.</p>
<pre><code class="language-julia">features, targets &#61; @load_boston
features &#61; DataFrames.DataFrame&#40;features&#41;;
@show size&#40;features&#41;
@show targets&#91;1:3&#93;
first&#40;features, 3&#41;</code></pre><pre><code class="plaintext code-output">size(features) = (506, 12)
targets[1:3] = [24.0, 21.6, 34.7]
3×12 DataFrame
 Row │ Crim     Zn       Indus    NOx      Rm       Age      Dis      Rad      Tax      PTRatio  Black    LStat
     │ Float64  Float64  Float64  Float64  Float64  Float64  Float64  Float64  Float64  Float64  Float64  Float64
─────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1 │ 0.00632     18.0     2.31    0.538    6.575     65.2   4.09        1.0    296.0     15.3   396.9      4.98
   2 │ 0.02731      0.0     7.07    0.469    6.421     78.9   4.9671      2.0    242.0     17.8   396.9      9.14
   3 │ 0.02729      0.0     7.07    0.469    7.185     61.1   4.9671      2.0    242.0     17.8   392.83     4.03</code></pre>
<pre><code class="language-julia">schema&#40;features&#41;</code></pre><pre><code class="plaintext code-output">┌─────────┬────────────┬─────────┐
│ names   │ scitypes   │ types   │
├─────────┼────────────┼─────────┤
│ Crim    │ Continuous │ Float64 │
│ Zn      │ Continuous │ Float64 │
│ Indus   │ Continuous │ Float64 │
│ NOx     │ Continuous │ Float64 │
│ Rm      │ Continuous │ Float64 │
│ Age     │ Continuous │ Float64 │
│ Dis     │ Continuous │ Float64 │
│ Rad     │ Continuous │ Float64 │
│ Tax     │ Continuous │ Float64 │
│ PTRatio │ Continuous │ Float64 │
│ Black   │ Continuous │ Float64 │
│ LStat   │ Continuous │ Float64 │
└─────────┴────────────┴─────────┘
</code></pre>
<p>We can also describe the dataframe</p>
<pre><code class="language-julia">DataFrames.describe&#40;features&#41;</code></pre><pre><code class="plaintext code-output">12×7 DataFrame
 Row │ variable  mean        min        median     max       nmissing  eltype
     │ Symbol    Float64     Float64    Float64    Float64   Int64     DataType
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ Crim        3.61352     0.00632    0.25651   88.9762         0  Float64
   2 │ Zn         11.3636      0.0        0.0      100.0            0  Float64
   3 │ Indus      11.1368      0.46       9.69      27.74           0  Float64
   4 │ NOx         0.554695    0.385      0.538      0.871          0  Float64
   5 │ Rm          6.28463     3.561      6.2085     8.78           0  Float64
   6 │ Age        68.5749      2.9       77.5      100.0            0  Float64
   7 │ Dis         3.79504     1.1296     3.20745   12.1265         0  Float64
   8 │ Rad         9.54941     1.0        5.0       24.0            0  Float64
   9 │ Tax       408.237     187.0      330.0      711.0            0  Float64
  10 │ PTRatio    18.4555     12.6       19.05      22.0            0  Float64
  11 │ Black     356.674       0.32     391.44     396.9            0  Float64
  12 │ LStat      12.6531      1.73      11.36      37.97           0  Float64</code></pre>
<p>Do the usual train/test partitioning. This is important so we can estimate generalisation.</p>
<pre><code class="language-julia">train, test &#61; partition&#40;eachindex&#40;targets&#41;, 0.70, rng&#61;StableRNG&#40;52&#41;&#41;</code></pre><pre><code class="plaintext code-output">([52, 17, 330, 191, 265, 172, 19, 481, 94, 493, 490, 463, 430, 282, 169, 408, 437, 89, 234, 72, 130, 461, 135, 398, 287, 351, 50, 363, 182, 346, 99, 80, 203, 255, 60, 366, 459, 87, 71, 359, 390, 200, 21, 142, 483, 369, 304, 505, 377, 121, 29, 37, 20, 65, 258, 281, 133, 362, 116, 426, 27, 211, 489, 165, 55, 420, 256, 149, 98, 495, 6, 69, 53, 260, 434, 318, 128, 168, 160, 70, 131, 90, 181, 331, 187, 321, 157, 223, 343, 110, 427, 198, 144, 348, 44, 176, 350, 113, 31, 482, 36, 303, 190, 396, 189, 380, 152, 251, 415, 245, 45, 114, 237, 141, 132, 136, 78, 283, 353, 16, 117, 263, 344, 63, 262, 424, 306, 11, 312, 372, 277, 43, 123, 86, 308, 416, 57, 289, 497, 405, 284, 272, 103, 236, 32, 502, 356, 75, 414, 28, 302, 208, 407, 143, 423, 59, 368, 466, 115, 197, 334, 473, 174, 242, 428, 462, 317, 111, 469, 84, 1, 153, 393, 498, 127, 231, 247, 79, 421, 381, 222, 455, 374, 9, 66, 395, 224, 18, 345, 139, 300, 202, 34, 192, 339, 24, 432, 352, 299, 354, 243, 328, 313, 292, 218, 269, 503, 4, 285, 394, 35, 389, 47, 291, 41, 436, 413, 442, 148, 496, 384, 173, 166, 48, 409, 288, 367, 81, 225, 338, 42, 112, 323, 324, 171, 446, 315, 464, 229, 319, 364, 491, 73, 137, 422, 365, 227, 38, 105, 271, 207, 74, 92, 298, 209, 278, 453, 275, 379, 470, 204, 444, 22, 332, 39, 458, 457, 163, 250, 178, 460, 201, 196, 314, 186, 268, 106, 316, 228, 468, 164, 124, 270, 406, 297, 118, 307, 341, 97, 7, 376, 474, 257, 467, 371, 62, 274, 412, 438, 439, 445, 311, 327, 241, 399, 403, 215, 125, 375, 180, 183, 146, 122, 388, 161, 488, 431, 238, 401, 476, 235, 433, 177, 452, 220, 296, 101, 383, 61, 456, 261, 46, 440, 342, 309, 167, 232, 23, 417, 347, 109, 355, 322, 253, 216, 120, 244, 26, 397, 170, 162, 67, 230, 154], [233, 385, 30, 91, 140, 335, 25, 358, 254, 226, 279, 156, 301, 214, 492, 96, 76, 249, 259, 400, 280, 83, 449, 159, 305, 88, 337, 3, 477, 199, 185, 494, 184, 402, 425, 392, 360, 378, 295, 479, 104, 441, 108, 290, 58, 273, 56, 294, 193, 10, 325, 478, 386, 49, 326, 82, 54, 206, 349, 129, 194, 107, 480, 475, 472, 195, 77, 252, 485, 248, 499, 155, 15, 219, 188, 382, 100, 504, 239, 387, 221, 443, 447, 179, 210, 418, 64, 150, 410, 465, 404, 12, 102, 276, 5, 212, 119, 486, 8, 501, 51, 310, 320, 340, 429, 95, 240, 451, 213, 175, 500, 293, 138, 333, 448, 145, 357, 134, 471, 205, 68, 126, 329, 391, 14, 33, 336, 370, 264, 217, 411, 13, 266, 454, 435, 267, 147, 286, 40, 2, 158, 373, 419, 85, 487, 450, 506, 151, 246, 484, 93, 361])</code></pre>
<p>Let us investigate some of the commonly tweaked LightGBM parameters. We start with looking at a learning curve for number of boostings.</p>
<pre><code class="language-julia">lgb &#61; LGBMRegressor&#40;&#41; #initialised a model with default params
mach &#61; machine&#40;lgb, features&#91;train, :&#93;, targets&#91;train, 1&#93;&#41;
curve &#61; learning_curve&#40;
    mach,
    resampling&#61;CV&#40;nfolds&#61;5&#41;,
    range&#61;range&#40;lgb, :num_iterations, lower&#61;2, upper&#61;500&#41;,
    resolution&#61;60,
    measure&#61;rms,
&#41;

using Plots
dims &#61; &#40;600, 370&#41;
plt &#61; plot&#40;curve.parameter_values, curve.measurements, size&#61;dims&#41;
xlabel&#33;&#40;&quot;Number of rounds&quot;, fontsize&#61;14&#41;
ylabel&#33;&#40;&quot;RMSE&quot;, fontsize&#61;14&#41;</code></pre><pre><code class="plaintext code-output">UndefVarError: `LGBMRegressor` not defined
</code></pre>
<p><span style="color:red;">// Image matching '/assets/end-to-end/boston-lgbm/code/lgbm_hp1.svg' not found. //</span></p>
<p>It looks like that we don&#39;t need to go much past 100 boosts</p>
<p>Since LightGBM is a gradient based learning method, we also have a learning rate parameter which controls the size of gradient updates.</p>
<p>Let us look at a learning curve for this parameter too</p>
<pre><code class="language-julia">lgb &#61; LGBMRegressor&#40;&#41; #initialised a model with default params
mach &#61; machine&#40;lgb, features&#91;train, :&#93;, targets&#91;train, 1&#93;&#41;

curve &#61; learning_curve&#40;
    mach,
    resampling&#61;CV&#40;nfolds&#61;5&#41;,
    range&#61;range&#40;lgb, :learning_rate, lower&#61;1e-3, upper&#61;1, scale&#61;:log&#41;,
    resolution&#61;60,
    measure&#61;rms,
&#41;

plot&#40;
    curve.parameter_values,
    curve.measurements,
    size&#61;dims,
    xscale &#61;:log10,
&#41;
xlabel&#33;&#40;&quot;Learning rate &#40;log scale&#41;&quot;, fontsize&#61;14&#41;
ylabel&#33;&#40;&quot;RMSE&quot;, fontsize&#61;14&#41;</code></pre><pre><code class="plaintext code-output">UndefVarError: `LGBMRegressor` not defined
</code></pre>
<p><span style="color:red;">// Image matching '/assets/end-to-end/boston-lgbm/code/lgbm_hp2.svg' not found. //</span></p>
<p>It seems like near 0.5 is a reasonable place. Bearing in mind that for lower values of learning rate we possibly require more boosting in order to converge, so the default value of 100 might not be sufficient for convergence. We leave this as an exercise to the reader.  We can still try to tune this parameter, however.</p>
<p>Finally let us check number of datapoints required to produce a leaf in an individual tree. This parameter controls the complexity of individual learner trees, and too low a value might lead to overfitting.</p>
<pre><code class="language-julia">lgb &#61; LGBMRegressor&#40;&#41; #initialised a model with default params
mach &#61; machine&#40;lgb, features&#91;train, :&#93;, targets&#91;train, 1&#93;&#41;</code></pre><pre><code class="plaintext code-output">UndefVarError: `LGBMRegressor` not defined
</code></pre>
<p>dataset is small enough and the lower and upper sets the tree to have certain number of leaves</p>
<pre><code class="language-julia">curve &#61; learning_curve&#40;
    mach,
    resampling&#61;CV&#40;nfolds&#61;5&#41;,
    range&#61;range&#40;lgb, :min_data_in_leaf, lower&#61;1, upper&#61;50&#41;,
    measure&#61;rms,
&#41;

plot&#40;curve.parameter_values, curve.measurements, size&#61;dims&#41;
xlabel&#33;&#40;&quot;Min data in leaf&quot;, fontsize&#61;14&#41;
ylabel&#33;&#40;&quot;RMSE&quot;, fontsize&#61;14&#41;</code></pre><pre><code class="plaintext code-output">UndefVarError: `lgb` not defined
</code></pre>
<p><span style="color:red;">// Image matching '/assets/end-to-end/boston-lgbm/code/lgbm_hp3.svg' not found. //</span></p>
<p>It does not seem like there is a huge risk for overfitting, and lower is better for this parameter.</p>
<p>Using the learning curves above we can select some small-ish ranges to jointly search for the best combinations of these parameters via cross validation.</p>
<pre><code class="language-julia">r1 &#61; range&#40;lgb, :num_iterations, lower&#61;50, upper&#61;100&#41;
r2 &#61; range&#40;lgb, :min_data_in_leaf, lower&#61;2, upper&#61;10&#41;
r3 &#61; range&#40;lgb, :learning_rate, lower&#61;1e-1, upper&#61;1e0&#41;
tuned_model &#61; TunedModel&#40;
    lgb,
    tuning&#61;RandomSearch&#40;&#41;,
    resampling&#61;CV&#40;rng&#61;StableRNG&#40;123&#41;&#41;,
    ranges&#61;&#91;r1,r2,r3&#93;,
    measure&#61;rms,
    n&#61;100,
&#41;
mach &#61; machine&#40;tuned_model, features, targets&#41;
fit&#33;&#40;mach, rows&#61;train&#41;;</code></pre><pre><code class="plaintext code-output">UndefVarError: `lgb` not defined
</code></pre>
<p>Let&#39;s see what the cross validation best model parameters turned out to be?</p>
<pre><code class="language-julia">best_model &#61; fitted_params&#40;mach&#41;.best_model
@show best_model.learning_rate
@show best_model.min_data_in_leaf
@show best_model.num_iterations</code></pre><pre><code class="plaintext code-output">UndefVarError: `mach` not defined
</code></pre>
<p>Great, and now let&#39;s predict using the held out data &#40;predicting using the <code>TunedModel</code> machine uses the best model trained on all the <code>train</code> data&#41;:</p>
<pre><code class="language-julia">predictions &#61; MLJ.predict&#40;mach, rows&#61;test&#41;
rms_score &#61; round&#40;rms&#40;predictions, targets&#91;test, 1&#93;&#41;, sigdigits&#61;4&#41;

@show rms_score</code></pre><pre><code class="plaintext code-output">UndefVarError: `mach` not defined
</code></pre>
<p>‎</p></div>

<div class="bottom-nav-container">
  <a id="prev-tutorial" style="text-decoration: none"><Button class="bottom-nav">
        <div>← Previous Tutorial</div>
        <div id="prev-label" class="button-label"> Home</div>
    </Button></a>
  <a id="next-tutorial" style="text-decoration: none"><Button class="bottom-nav">
        <div>Next Tutorial →</div>
        <div id="next-label" class="button-label">Home</div> 
    </Button></a>
</div>
<div class="page-foot">
  <div class="copyright">
    &copy; Thibaut Lienart, Anthony Blaom, Sebastian Vollmer and collaborators. Last modified: April 15, 2024. Website built with <a
      href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>.
  </div>
</div></div><!-- CONTENT ENDS HERE -->
</div> <!-- end of id=main -->
</div> <!-- end of id=layout -->
<!-- for collapse functionality -->
<script src="/DataScienceTutorials.jl/libs/collapse/collapse.js"></script>
<script src="/DataScienceTutorials.jl/libs/pure/ui.min.js"></script>
<!-- head and footer-nav -->
<script src="/DataScienceTutorials.jl/libs/nav/head.js"  type="module"></script>
<!-- landing page -->
<script src="/DataScienceTutorials.jl/libs/landing/landing.js"></script>
<!-- navigation bar -->
<script src="/DataScienceTutorials.jl/libs/nav/nav.js"></script>
<!-- responsive navigation bar -->
<script src="/DataScienceTutorials.jl/libs/nav/responsive.js"></script>


<script src="/DataScienceTutorials.jl/libs/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>


</body>

</html>