<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
   <!-- Syntax highlighting via Prism, note: restricted langs -->
<link rel="stylesheet" href="/DataScienceTutorials.jl/libs/highlight/github.min.css">
 
  <link rel="stylesheet" href="/DataScienceTutorials.jl/css/landing.css">
  <link rel="stylesheet" href="/DataScienceTutorials.jl/css/franklin.css">
  <link rel="stylesheet" href="/DataScienceTutorials.jl/css/pure.css">
  <link rel="stylesheet" href="/DataScienceTutorials.jl/css/side-menu.css">
  <link rel="stylesheet" href="/DataScienceTutorials.jl/css/nav.css">
  <link rel="stylesheet" href="/DataScienceTutorials.jl/css/extra.css">
  <!-- <link rel="icon" href="/DataScienceTutorials.jl/assets/infra/favicon.gif"> -->
   <title>Choosing and evaluating a model</title> 
  <!-- LUNR -->
  <script src="/DataScienceTutorials.jl/libs/lunr/lunr.min.js"></script>
  <script src="/DataScienceTutorials.jl/libs/lunr/lunr_index.js"></script>
  <script src="/DataScienceTutorials.jl/libs/lunr/lunrclient.min.js"></script>
</head>

<body>
  <div id="layout">
    <!-- Menu toggle / hamburger icon -->
    <a href="#menu" id="menuLink" class="menu-link"><span></span></a>
    <div id="menu" style="display: none;">
      <div class="pure-menu">
        <a href="/DataScienceTutorials.jl/" id="menu-logo-link">
          <div class="menu-logo">
            <!-- <img id="menu-logo" alt="MLJ Logo" src="/DataScienceTutorials.jl/assets/infra/MLJLogo2.svg" /> -->
            <p><strong>Data Science Tutorials</strong></p>
          </div>
        </a>
        <form id="lunrSearchForm" name="lunrSearchForm">
          <input class="search-input" name="q" placeholder="Search in tutorials..." type="text">
          <input type="submit" value="Search" formaction="/DataScienceTutorials.jl/search/index.html" style="display:none">
        </form>
        <!-- LIST OF MENU ITEMS -->
        <ul class="pure-menu-list">
          <li class="pure-menu-item pure-menu-top-item "><a href="/DataScienceTutorials.jl/"
              class="pure-menu-link"><strong>Home</strong></a></li>

          <!-- DATA BASICS -->
          <div class="dropdown">
            <li class="pure-menu-sublist-title"><strong>Data Basics</strong></li>
          </div>
          <div class="collapse dropdown-content">
            <ul class="pure-menu-sublist">
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/data/loading/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Loading
                  data</a></li>
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/data/dataframe/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Data
                  Frames</a></li>
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/data/categorical/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span>
                  Categorical Arrays</a></li>
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/data/scitype/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Scientific
                  Type</a></li>
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/data/processing/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Data
                  processing</a></li>
            </ul>
          </div>

          <!-- GETTING STARTED WITH MLJ -->
          <div class="dropdown">
            <li class="pure-menu-sublist-title"><strong>Getting Started</strong></li>
          </div>
          <div class="collapse dropdown-content">
            <ul class="pure-menu-sublist">
              <li
                class="pure-menu-item ">
                <a href="/DataScienceTutorials.jl/getting-started/choosing-a-model/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Choosing a model</a>
              </li>
              <li class="pure-menu-item ">
                <a href="/DataScienceTutorials.jl/getting-started/fit-and-predict/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Fit, predict, transform</a>
              </li>
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/getting-started/model-tuning/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Model tuning</a></li>
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/getting-started/ensembles/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span>
                  Ensembles</a></li>
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/getting-started/ensembles-2/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Ensembles 2</a></li>
              <li
                class="pure-menu-item ">
                <a href="/DataScienceTutorials.jl/getting-started/composing-models/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Composing models</a>
              </li>
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/getting-started/stacking/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span>
                  Stacking</a></li>
            </ul>
          </div>
          <!-- INTRO TO STATS LEARNING -->
          <div class="dropdown">
            <li class="pure-menu-sublist-title"><strong>Intro to Stats Learning</strong></li>
          </div>
          <div class="collapse dropdown-content">
            <ul class="pure-menu-sublist" id=isl>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-2/"
                  class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Lab 2</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-3/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 3</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-4/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 4</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-5/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 5</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-6b/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 6b</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-8/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 8</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-9/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 9</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/isl/lab-10/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Lab 10</a></li>
            </ul>
          </div>
          <!-- End to End -->
          <div class="dropdown">
            <li class="pure-menu-sublist-title"><strong>End to End</strong></li>
          </div>
          <div class="dropdown-content collapse">
            <ul class="pure-menu-sublist" >
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/end-to-end/telco/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span>Telco
                  Churn</a></li>
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/end-to-end/AMES/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> AMES</a>
              </li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/wine/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Wine</a></li>
              <li class="pure-menu-item "><a
                  href="/DataScienceTutorials.jl/end-to-end/crabs-xgb/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span>
                  Crabs (XGB)</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/horse/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Horse</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/HouseKingCounty/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> King County Houses</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/airfoil" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Airfoil </a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/boston-lgbm" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Boston (lgbm) </a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/glm/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Using GLM.jl </a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/powergen/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Power Generation </a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/boston-flux" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Boston (Flux) </a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/breastcancer" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Breast Cancer</a></li>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/end-to-end/creditfraud" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Credit Fraud</a></li>
            </ul>
          </div>
          <!-- ADVANCED EXAMPLES -->
          <div class="dropdown">
            <li class="pure-menu-sublist-title"><strong>Advanced Examples</strong></li>
          </div>
          <div class="dropdown-content collapse">
            <ul class="pure-menu-sublist" id=adv>
              <li class="pure-menu-item "><a href="/DataScienceTutorials.jl/advanced/ensembles-3/" class="pure-menu-link"><span
                    style="padding-right:0.5rem;">•</span> Ensembles (3)</a></li>
            </ul>
          </div>
      </div>
      </ul>
      <!-- END OF LIST OF MENU ITEMS -->
    </div>
  </div>
  <div id="nav" class="navigation">
    <div class="nav-container">
      <div class="brand">
        <a href="/DataScienceTutorials.jl/">DataScienceTutorials.jl</a>
      </div>
      <nav>
        <div class="nav-mobile"><a id="nav-toggle" href="#!"><span></span></a></div>
        <ul class="nav-list">
        <!-- horizontal navigation bar gets injected -->
        </ul>
      </nav>
    </div>
  </div>
  <div id="main"> <!-- Closed in foot -->
    

    <!-- Content appended here --><div class="franklin-content"><h1 id="choosing_and_evaluating_a_model"><a href="#choosing_and_evaluating_a_model" class="header-anchor">Choosing and evaluating a model</a></h1>
<em>To ensure code in this tutorial runs as shown, download the tutorial <a href="https://raw.githubusercontent.com/juliaai/DataScienceTutorials.jl/gh-pages/__generated/A-model-choice.tar.gz">project folder</a> and follow <a href="/DataScienceTutorials.jl/#learning_by_doing">these instructions</a>.</em></p>
<p><em>If you have questions or suggestions about this tutorial, please open an issue <a href="https://github.com/JuliaAI/DataScienceTutorials.jl/issues/new">here</a>.</em></p>
<p><div class="franklin-toc"><ol><li><a href="#data_and_its_interpretation">Data and its interpretation</a><ol><li><a href="#machine_type_and_scientific_type">Machine type and scientific type</a></li><li><a href="#unpacking_data">Unpacking data</a></li></ol></li><li><a href="#choosing_a_model">Choosing a model</a><ol><li><a href="#model_search">Model search</a></li><li><a href="#loading_a_model">Loading a model</a></li></ol></li></ol></div>
<p></p>
<div class="dropdown"><h2 id="data_and_its_interpretation"><a href="#data_and_its_interpretation" class="header-anchor">Data and its interpretation</a></h2></div>
<div class="dropdown-content"><div class="dropdown"><h3 id="machine_type_and_scientific_type"><a href="#machine_type_and_scientific_type" class="header-anchor">Machine type and scientific type</a></h3></div>
<div class="dropdown-content"><pre><code class="language-julia">using RDatasets
using MLJ
iris &#61; dataset&#40;&quot;datasets&quot;, &quot;iris&quot;&#41;

first&#40;iris, 3&#41; |&gt; pretty</code></pre><pre><code class="plaintext code-output">┌─────────────┬────────────┬─────────────┬────────────┬─────────────────────────────────┐
│ SepalLength │ SepalWidth │ PetalLength │ PetalWidth │ Species                         │
│ Float64     │ Float64    │ Float64     │ Float64    │ CategoricalValue{String, UInt8} │
│ Continuous  │ Continuous │ Continuous  │ Continuous │ Multiclass{3}                   │
├─────────────┼────────────┼─────────────┼────────────┼─────────────────────────────────┤
│ 5.1         │ 3.5        │ 1.4         │ 0.2        │ setosa                          │
│ 4.9         │ 3.0        │ 1.4         │ 0.2        │ setosa                          │
│ 4.7         │ 3.2        │ 1.3         │ 0.2        │ setosa                          │
└─────────────┴────────────┴─────────────┴────────────┴─────────────────────────────────┘
</code></pre>
<p>Observe that below each column name there are two <em>types</em> given: the first one is the <em>machine type</em> and the second one is the <em>scientific type</em>.</p>
<ul>
<li><p><strong>machine type</strong>: is the Julia type the data is currently encoded as, for instance <code>Float64</code>,</p>
</li>
<li><p><strong>scientific type</strong>: is a type corresponding to how the data should be <em>interpreted</em>, for instance <code>Multiclass&#123;3&#125;</code>.</p>
</li>
</ul>
<p>If you want to specify a different scientific type than the one inferred, you can do so by using the function <code>coerce</code> along with pairs of column names and scientific types:</p>
<pre><code class="language-julia">iris2 &#61; coerce&#40;iris, :PetalWidth &#61;&gt; OrderedFactor&#41;
first&#40;iris2&#91;:, &#91;:PetalLength, :PetalWidth&#93;&#93;, 1&#41; |&gt; pretty</code></pre><pre><code class="plaintext code-output">┌─────────────┬───────────────────────────────────┐
│ PetalLength │ PetalWidth                        │
│ Float64     │ CategoricalValue{Float64, UInt32} │
│ Continuous  │ OrderedFactor{22}                 │
├─────────────┼───────────────────────────────────┤
│ 1.4         │ 0.2                               │
└─────────────┴───────────────────────────────────┘
</code></pre>
<p>‎</p></div>
<div class="dropdown"><h3 id="unpacking_data"><a href="#unpacking_data" class="header-anchor">Unpacking data</a></h3></div>
<div class="dropdown-content"><p>The function <code>unpack</code> helps specify the target and the input for a regression or classification task</p>
<pre><code class="language-julia">y, X &#61; unpack&#40;iris, &#61;&#61;&#40;:Species&#41;&#41;
first&#40;X, 1&#41; |&gt; pretty</code></pre><pre><code class="plaintext code-output">┌─────────────┬────────────┬─────────────┬────────────┐
│ SepalLength │ SepalWidth │ PetalLength │ PetalWidth │
│ Float64     │ Float64    │ Float64     │ Float64    │
│ Continuous  │ Continuous │ Continuous  │ Continuous │
├─────────────┼────────────┼─────────────┼────────────┤
│ 5.1         │ 3.5        │ 1.4         │ 0.2        │
└─────────────┴────────────┴─────────────┴────────────┘
</code></pre>
<p>The two arguments after the dataframes should be understood as <em>functions</em> over column names specifying the target and the input data respectively. Let&#39;s look in more details at what we used here:</p>
<ul>
<li><p><code>&#61;&#61;&#40;:Species&#41;</code> is a shorthand to specify that the target should be the column with name equal to <code>:Species</code>,</p>
</li>
<li><p><code>colname -&gt; true</code> indicates that every other column is to be taken as input</p>
</li>
</ul>
<p>Let&#39;s try another one:</p>
<pre><code class="language-julia">y, X &#61; unpack&#40;iris, &#61;&#61;&#40;:Species&#41;, &#33;&#61;&#40;:PetalLength&#41;&#41;
first&#40;X, 1&#41; |&gt; pretty</code></pre><pre><code class="plaintext code-output">┌─────────────┬────────────┬────────────┐
│ SepalLength │ SepalWidth │ PetalWidth │
│ Float64     │ Float64    │ Float64    │
│ Continuous  │ Continuous │ Continuous │
├─────────────┼────────────┼────────────┤
│ 5.1         │ 3.5        │ 0.2        │
└─────────────┴────────────┴────────────┘
</code></pre>
<p>You can also use the shorthand <code>@load_iris</code> for such common examples:</p>
<pre><code class="language-julia">X, y &#61; @load_iris;</code></pre>
<p>‎</p></div>
<p>‎</p></div>
<div class="dropdown"><h2 id="choosing_a_model"><a href="#choosing_a_model" class="header-anchor">Choosing a model</a></h2></div>
<div class="dropdown-content"><div class="dropdown"><h3 id="model_search"><a href="#model_search" class="header-anchor">Model search</a></h3></div>
<div class="dropdown-content"><p>In MLJ, a <em>model</em> is a struct storing the <em>hyperparameters</em> of the learning algorithm indicated by the struct name &#40;and only that&#41;.</p>
<p>A number of models are available in MLJ, usually thanks to external packages interfacing with MLJ &#40;see also <code><a href="https://github.com/alan-turing-institute/MLJModels.jl">MLJModels.jl</a></code>&#41;. In order to see which ones are appropriate for the data you have and its scientific interpretation, you can use the function <code>models</code> along with the function <code>matching</code>; let us look specifically at models which support a probabilistic output:</p>
<pre><code class="language-julia">for m in models&#40;matching&#40;X, y&#41;&#41;
    if m.prediction_type &#61;&#61; :probabilistic
        println&#40;rpad&#40;m.name, 30&#41;, &quot;&#40;&#36;&#40;m.package_name&#41;&#41;&quot;&#41;
    end
end</code></pre><pre><code class="plaintext code-output">AdaBoostClassifier            (MLJScikitLearnInterface)
AdaBoostStumpClassifier       (DecisionTree)
BaggingClassifier             (MLJScikitLearnInterface)
BayesianLDA                   (MLJScikitLearnInterface)
BayesianLDA                   (MultivariateStats)
BayesianQDA                   (MLJScikitLearnInterface)
BayesianSubspaceLDA           (MultivariateStats)
CatBoostClassifier            (CatBoost)
ConstantClassifier            (MLJModels)
DecisionTreeClassifier        (BetaML)
DecisionTreeClassifier        (DecisionTree)
DummyClassifier               (MLJScikitLearnInterface)
EvoTreeClassifier             (EvoTrees)
ExtraTreesClassifier          (MLJScikitLearnInterface)
GaussianNBClassifier          (MLJScikitLearnInterface)
GaussianNBClassifier          (NaiveBayes)
GaussianProcessClassifier     (MLJScikitLearnInterface)
GradientBoostingClassifier    (MLJScikitLearnInterface)
HistGradientBoostingClassifier(MLJScikitLearnInterface)
KNNClassifier                 (NearestNeighborModels)
KNeighborsClassifier          (MLJScikitLearnInterface)
KernelPerceptronClassifier    (BetaML)
LDA                           (MultivariateStats)
LGBMClassifier                (LightGBM)
LogisticCVClassifier          (MLJScikitLearnInterface)
LogisticClassifier            (MLJLinearModels)
LogisticClassifier            (MLJScikitLearnInterface)
MultinomialClassifier         (MLJLinearModels)
NeuralNetworkClassifier       (BetaML)
NeuralNetworkClassifier       (MLJFlux)
PegasosClassifier             (BetaML)
PerceptronClassifier          (BetaML)
ProbabilisticNuSVC            (LIBSVM)
ProbabilisticSGDClassifier    (MLJScikitLearnInterface)
ProbabilisticSVC              (LIBSVM)
RandomForestClassifier        (BetaML)
RandomForestClassifier        (DecisionTree)
RandomForestClassifier        (MLJScikitLearnInterface)
StableForestClassifier        (SIRUS)
StableRulesClassifier         (SIRUS)
SubspaceLDA                   (MultivariateStats)
XGBoostClassifier             (XGBoost)
</code></pre>
<p>‎</p></div>
<div class="dropdown"><h3 id="loading_a_model"><a href="#loading_a_model" class="header-anchor">Loading a model</a></h3></div>
<div class="dropdown-content"><p>Most models are implemented outside of the MLJ ecosystem; you therefore have to <em>load models</em> using the <code>@load</code> command.</p>
<p><strong>Note</strong>: you <em>must</em> have the package from which the model is loaded available in your environment &#40;in this case <code><a href="https://github.com/bensadeghi/DecisionTree.jl">DecisionTree.jl</a></code>&#41; otherwise MLJ will not be able to load the model.</p>
<p>For instance, let&#39;s say you want to fit a K-Nearest Neighbours classifier:</p>
<pre><code class="language-julia">knc &#61; @load KNeighborsClassifier</code></pre><pre><code class="plaintext code-output">import MLJScikitLearnInterface ✔
MLJScikitLearnInterface.KNeighborsClassifier</code></pre>
<p>In some cases, there may be several packages offering the same model, for instance <code>LinearRegressor</code> is offered by both <code><a href="https://github.com/JuliaStats/GLM.jl">GLM.jl</a></code> and <code><a href="https://github.com/cstjean/ScikitLearn.jl">ScikitLearn.jl</a></code> so you will need to specify the package you would like to use by adding <code>pkg&#61;&quot;ThePackage&quot;</code> in the load command:</p>
<pre><code class="language-julia">linreg &#61; @load LinearRegressor pkg&#61;GLM</code></pre><pre><code class="plaintext code-output">import MLJGLMInterface ✔
MLJGLMInterface.LinearRegressor</code></pre>
<p>‎</p></div>
<p>‎</p></div>

<div class="bottom-nav-container">
  <a id="prev-tutorial" style="text-decoration: none"><Button class="bottom-nav">
        <div>← Previous Tutorial</div>
        <div id="prev-label" class="button-label"> Home</div>
    </Button></a>
  <a id="next-tutorial" style="text-decoration: none"><Button class="bottom-nav">
        <div>Next Tutorial →</div>
        <div id="next-label" class="button-label">Home</div> 
    </Button></a>
</div>
<div class="page-foot">
  <div class="copyright">
    &copy; Thibaut Lienart, Anthony Blaom, Sebastian Vollmer and collaborators. Last modified: April 02, 2024. Website built with <a
      href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>.
  </div>
</div></div><!-- CONTENT ENDS HERE -->
</div> <!-- end of id=main -->
</div> <!-- end of id=layout -->
<!-- for collapse functionality -->
<script src="/DataScienceTutorials.jl/libs/collapse/collapse.js"></script>
<script src="/DataScienceTutorials.jl/libs/pure/ui.min.js"></script>
<!-- head and footer-nav -->
<script src="/DataScienceTutorials.jl/libs/nav/head.js"></script>
<script src="/DataScienceTutorials.jl/libs/nav/footer-nav.js"></script>
<!-- landing page -->
<script src="/DataScienceTutorials.jl/libs/landing/landing.js"></script>
<!-- navigation bar -->
<script src="/DataScienceTutorials.jl/libs/nav/nav.js"></script>
<!-- responsive navigation bar -->
<script src="/DataScienceTutorials.jl/libs/nav/responsive.js"></script>


<script src="/DataScienceTutorials.jl/libs/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>


</body>

</html>