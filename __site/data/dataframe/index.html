<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
   <!-- Syntax highlighting via Prism, note: restricted langs -->
<link rel="stylesheet" href="/libs/highlight/github.min.css">
 
  <link rel="stylesheet" href="/css/franklin.css">
  <link rel="stylesheet" href="/css/pure.css">
  <link rel="stylesheet" href="/css/side-menu.css">
  <link rel="stylesheet" href="/css/extra.css">
  <!-- <link rel="icon" href="/assets/infra/favicon.gif"> -->
   <title>Manipulating a DataFrame</title>  
  <!-- LUNR -->
  <script src="/libs/lunr/lunr.min.js"></script>
  <script src="/libs/lunr/lunr_index.js"></script>
  <script src="/libs/lunr/lunrclient.min.js"></script>
</head>
<body>
  <div id="layout">
    <!-- Menu toggle / hamburger icon -->
    <a href="#menu" id="menuLink" class="menu-link"><span></span></a>
    <div id="menu">
      <div class="pure-menu">
        <a href="/" id="menu-logo-link">
          <div class="menu-logo">
            <!-- <img id="menu-logo" alt="MLJ Logo" src="/assets/infra/MLJLogo2.svg" /> -->
            <p><strong>Data Science Tutorials</strong></p>
          </div>
        </a>
        <form id="lunrSearchForm" name="lunrSearchForm">
          <input class="search-input" name="q" placeholder="Enter search term" type="text">
          <input type="submit" value="Search" formaction="/search/index.html" style="visibility:hidden">
        </form>
  <!-- LIST OF MENU ITEMS -->
  <ul class="pure-menu-list">
    <li class="pure-menu-item pure-menu-top-item "><a href="/" class="pure-menu-link"><strong>Home</strong></a></li>

    <!-- DATA BASICS -->
    <li class="pure-menu-sublist-title"><strong>Data basics</strong></li>
    <ul class="pure-menu-sublist">
      <li class="pure-menu-item "><a href="/data/loading/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Loading data</a></li>
      <li class="pure-menu-item "><a href="/data/dataframe/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Data Frames</a></li>
      <li class="pure-menu-item "><a href="/data/categorical/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Categorical Arrays</a></li>
      <li class="pure-menu-item "><a href="/data/scitype/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Scientific Type</a></li>
      <li class="pure-menu-item "><a href="/data/processing/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Data processing</a></li>
    </ul>

    <!-- GETTING STARTED WITH MLJ -->
    <li class="pure-menu-sublist-title"><strong>Getting started</strong></li>
    <ul class="pure-menu-sublist">
      <li class="pure-menu-item "><a href="/getting-started/choosing-a-model/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Choosing a model</a></li>
      <li class="pure-menu-item "><a href="/getting-started/fit-and-predict/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Fit, predict, transform</a></li>
      <li class="pure-menu-item "><a href="/getting-started/model-tuning/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Model tuning</a></li>
      <li class="pure-menu-item "><a href="/getting-started/ensembles/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Ensembles</a></li>
      <li class="pure-menu-item "><a href="/getting-started/ensembles-2/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Ensembles (2)</a></li>
      <li class="pure-menu-item "><a href="/getting-started/ensembles-3/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Ensembles (3)</a></li>
      <li class="pure-menu-item "><a href="/getting-started/composing-models/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Composing models</a></li>
      <li class="pure-menu-item "><a href="/getting-started/learning-networks/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Learning networks</a></li>
      <li class="pure-menu-item "><a href="/getting-started/learning-networks-2/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Learning networks (2)</a></li>
      <li class="pure-menu-item "><a href="/getting-started/stacking/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Stacking</a></li>
    </ul>

    <!-- INTRO TO STATS LEARNING -->
    <li class="pure-menu-sublist-title"><strong>Intro to Stats Learning</strong></li>
    <ul class="pure-menu-sublist" id=isl>
      <li class="pure-menu-item "><a href="/isl/lab-2/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Lab 2</a></li>
      <li class="pure-menu-item "><a href="/isl/lab-3/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Lab 3</a></li>
      <li class="pure-menu-item "><a href="/isl/lab-4/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Lab 4</a></li>
      <li class="pure-menu-item "><a href="/isl/lab-5/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Lab 5</a></li>
      <li class="pure-menu-item "><a href="/isl/lab-6b/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Lab 6b</a></li>
      <li class="pure-menu-item "><a href="/isl/lab-8/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Lab 8</a></li>
      <li class="pure-menu-item "><a href="/isl/lab-9/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Lab 9</a></li>
      <li class="pure-menu-item "><a href="/isl/lab-10/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Lab 10</a></li>
    </ul>

    <!-- END TO END EXAMPLES -->
    <li class="pure-menu-sublist-title"><strong>End to end examples</strong></li>
    <ul class="pure-menu-sublist" id=e2e>
      <li class="pure-menu-item "><a href="/end-to-end/AMES/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> AMES</a></li>
      <li class="pure-menu-item "><a href="/end-to-end/wine/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Wine</a></li>
      <li class="pure-menu-item "><a href="/end-to-end/crabs-xgb/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Crabs (XGB)</a></li>
      <li class="pure-menu-item "><a href="/end-to-end/horse/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Horse</a></li>
      <li class="pure-menu-item "><a href="/end-to-end/HouseKingCounty/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> King County Houses</a></li>
      <li class="pure-menu-item "><a href="/end-to-end/airfoil" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Airfoil </a></li>
      <li class="pure-menu-item "><a href="/end-to-end/boston-lgbm" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Boston (lgbm) </a></li>
      <li class="pure-menu-item "><a href="/end-to-end/glm/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Using GLM.jl </a></li>
      <li class="pure-menu-item "><a href="/end-to-end/powergen/" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Power Generation </a></li>
      <li class="pure-menu-item "><a href="/end-to-end/boston-flux" class="pure-menu-link"><span style="padding-right:0.5rem;">•</span> Boston (Flux) </a></li>
    </ul>
  </ul>
  <!-- END OF LIST OF MENU ITEMS -->
      </div>
    </div>
    <div id="main"> <!-- Closed in foot -->
      

<!-- Content appended here -->
<div class="franklin-content"><h1 id="manipulating_a_dataframe"><a href="#manipulating_a_dataframe" class="header-anchor">Manipulating a DataFrame</a></h1>
<em>Download the</em> <a href="https://raw.githubusercontent.com/alan-turing-institute/DataScienceTutorials.jl/gh-pages/generated/notebooks/D0-dataframe.ipynb" target="_blank"><em>notebook</em></a>, <em>the</em> <a href="https://raw.githubusercontent.com/alan-turing-institute/DataScienceTutorials.jl/gh-pages/generated/scripts/D0-dataframe-raw.jl" target="_blank"><em>raw script</em></a>, <em>or the</em> <a href="https://raw.githubusercontent.com/alan-turing-institute/DataScienceTutorials.jl/gh-pages/generated/scripts/D0-dataframe.jl" target="_blank"><em>annotated script</em></a><em>for this tutorial &#40;right-click on the link and save&#41;.</em> <div class="franklin-toc"><ol><li><a href="#basics">Basics</a><ol><li><a href="#accessing_data">Accessing data</a></li><li><a href="#describing_the_data">Describing the data</a></li><li><a href="#converting_the_data">Converting the data</a></li><li><a href="#adding_columns">Adding columns</a></li><li><a href="#missing_values">Missing values</a></li></ol></li><li><a href="#split-apply-combine">Split-Apply-Combine</a><ol><li><a href="#groupby"><code>groupby</code></a></li><li><a href="#combine"><code>combine</code></a></li><li><a href="#combine_with_groupby"><code>combine</code> with <code>groupby</code></a></li></ol></li></ol></div><p>This tutorial is loosely adapted from <a href="https://pandas.pydata.org/pandas-docs/stable/getting_started/10min.html">this pandas tutorial</a> as well as the <a href="http://juliadata.github.io/DataFrames.jl/latest/man/getting_started/">DataFrames.jl documentation</a>. It is by no means meant to be a complete introduction, rather, it focuses on some key functionalities that are particularly useful in a classical machine learning context.</p>
<h2 id="basics"><a href="#basics" class="header-anchor">Basics</a></h2>
<p>To start with, we will use the <code>Boston</code> dataset which is very simple.</p>
<pre><code class="language-julia">using RDatasets
using DataFrames

boston &#61; dataset&#40;&quot;MASS&quot;, &quot;Boston&quot;&#41;;</code></pre>
<p>The <code>dataset</code> function returns a <code>DataFrame</code> object:</p>
<pre><code class="language-julia">typeof&#40;boston&#41;</code></pre><pre><code class="plaintext">DataFrames.DataFrame</code></pre>
<h3 id="accessing_data"><a href="#accessing_data" class="header-anchor">Accessing data</a></h3>
<p>Intuitively a DataFrame is just a wrapper around a number of columns, each of which is a <code>Vector</code> of some type with a name&quot;</p>
<pre><code class="language-julia">names&#40;boston&#41;</code></pre><pre><code class="plaintext">14-element Vector{String}:
 "Crim"
 "Zn"
 "Indus"
 "Chas"
 "NOx"
 "Rm"
 "Age"
 "Dis"
 "Rad"
 "Tax"
 "PTRatio"
 "Black"
 "LStat"
 "MedV"</code></pre>
<p>You can view the first few rows using <code>first</code> and specifying a number of rows:</p>
<pre><code class="language-julia">first&#40;boston, 4&#41;</code></pre><pre><code class="plaintext">4×14 DataFrame
 Row │ Crim     Zn       Indus    Chas   NOx      Rm       Age      Dis      Rad    Tax    PTRatio  Black    LStat    MedV
     │ Float64  Float64  Float64  Int64  Float64  Float64  Float64  Float64  Int64  Int64  Float64  Float64  Float64  Float64
─────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1 │ 0.00632     18.0     2.31      0    0.538    6.575     65.2   4.09        1    296     15.3   396.9      4.98     24.0
   2 │ 0.02731      0.0     7.07      0    0.469    6.421     78.9   4.9671      2    242     17.8   396.9      9.14     21.6
   3 │ 0.02729      0.0     7.07      0    0.469    7.185     61.1   4.9671      2    242     17.8   392.83     4.03     34.7
   4 │ 0.03237      0.0     2.18      0    0.458    6.998     45.8   6.0622      3    222     18.7   394.63     2.94     33.4</code></pre>
<p>You can access one of those columns easily using <code>.colname</code>, this returns a vector that you can access like any Julia vector:</p>
<pre><code class="language-julia">boston.Crim&#91;1:5&#93;</code></pre><pre><code class="plaintext">5-element Vector{Float64}:
 0.00632
 0.02731
 0.02729
 0.03237
 0.06905</code></pre>
<p>You can also just access the dataframe as you would a big matrix:</p>
<pre><code class="language-julia">boston&#91;3, 5&#93;</code></pre><pre><code class="plaintext">0.469</code></pre>
<p>or specifying a range of rows/columns:</p>
<pre><code class="language-julia">boston&#91;1:5, &#91;:Crim, :Zn&#93;&#93;</code></pre><pre><code class="plaintext">5×2 DataFrame
 Row │ Crim     Zn
     │ Float64  Float64
─────┼──────────────────
   1 │ 0.00632     18.0
   2 │ 0.02731      0.0
   3 │ 0.02729      0.0
   4 │ 0.03237      0.0
   5 │ 0.06905      0.0</code></pre>
<p>or, similarly,</p>
<pre><code class="language-julia">boston&#91;1:5, 1:2&#93;</code></pre><pre><code class="plaintext">5×2 DataFrame
 Row │ Crim     Zn
     │ Float64  Float64
─────┼──────────────────
   1 │ 0.00632     18.0
   2 │ 0.02731      0.0
   3 │ 0.02729      0.0
   4 │ 0.03237      0.0
   5 │ 0.06905      0.0</code></pre>
<p>The <code>select</code> function is very convenient to get sub dataframes of interest:</p>
<pre><code class="language-julia">b1 &#61; select&#40;boston, &#91;:Crim, :Zn, :Indus&#93;&#41;
first&#40;b1, 2&#41;</code></pre><pre><code class="plaintext">2×3 DataFrame
 Row │ Crim     Zn       Indus
     │ Float64  Float64  Float64
─────┼───────────────────────────
   1 │ 0.00632     18.0     2.31
   2 │ 0.02731      0.0     7.07</code></pre>
<p>The <code>Not</code> syntax is  also very  useful:</p>
<pre><code class="language-julia">b2 &#61; select&#40;boston, Not&#40;:NOx&#41;&#41;
first&#40;b2, 2&#41;</code></pre><pre><code class="plaintext">2×13 DataFrame
 Row │ Crim     Zn       Indus    Chas   Rm       Age      Dis      Rad    Tax    PTRatio  Black    LStat    MedV
     │ Float64  Float64  Float64  Int64  Float64  Float64  Float64  Int64  Int64  Float64  Float64  Float64  Float64
─────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1 │ 0.00632     18.0     2.31      0    6.575     65.2   4.09        1    296     15.3    396.9     4.98     24.0
   2 │ 0.02731      0.0     7.07      0    6.421     78.9   4.9671      2    242     17.8    396.9     9.14     21.6</code></pre>
<p>Finally, if you would like to drop columns, you can use <code>select&#33;</code> which will mutate the dataframe in place:</p>
<pre><code class="language-julia">select&#33;&#40;b1, Not&#40;:Crim&#41;&#41;
first&#40;b1, 2&#41;</code></pre><pre><code class="plaintext">2×2 DataFrame
 Row │ Zn       Indus
     │ Float64  Float64
─────┼──────────────────
   1 │    18.0     2.31
   2 │     0.0     7.07</code></pre>
<h3 id="describing_the_data"><a href="#describing_the_data" class="header-anchor">Describing the data</a></h3>
<p><code>StatsBase</code> offers a convenient <code>describe</code> function which you can use on a DataFrame to get an overview of the data:</p>
<pre><code class="language-julia">using StatsBase
describe&#40;boston, :min, :max, :mean, :median, :std&#41;</code></pre><pre><code class="plaintext">14×6 DataFrame
 Row │ variable  min      max      mean        median     std
     │ Symbol    Real     Real     Float64     Float64    Float64
─────┼───────────────────────────────────────────────────────────────
   1 │ Crim      0.00632  88.9762    3.61352     0.25651    8.60155
   2 │ Zn            0.0    100.0   11.3636      0.0       23.3225
   3 │ Indus        0.46    27.74   11.1368      9.69       6.86035
   4 │ Chas            0        1    0.06917     0.0        0.253994
   5 │ NOx         0.385    0.871    0.554695    0.538      0.115878
   6 │ Rm          3.561     8.78    6.28463     6.2085     0.702617
   7 │ Age           2.9    100.0   68.5749     77.5       28.1489
   8 │ Dis        1.1296  12.1265    3.79504     3.20745    2.10571
   9 │ Rad             1       24    9.54941     5.0        8.70726
  10 │ Tax           187      711  408.237     330.0      168.537
  11 │ PTRatio      12.6     22.0   18.4555     19.05       2.16495
  12 │ Black        0.32    396.9  356.674     391.44      91.2949
  13 │ LStat        1.73    37.97   12.6531     11.36       7.14106
  14 │ MedV          5.0     50.0   22.5328     21.2        9.1971</code></pre>
<p>You can pass a number of symbols to the <code>describe</code> function to indicate which statistics to compute for each feature:</p>
<ul>
<li><p><code>mean</code>, <code>std</code>, <code>min</code>, <code>max</code>, <code>median</code>, <code>first</code>, <code>last</code> are all fairly self explanatory</p>
</li>
<li><p><code>q25</code>, <code>q75</code> are respectively for the 25th and 75th percentile,</p>
</li>
<li><p><code>eltype</code>, <code>nunique</code>, <code>nmissing</code> can also be used</p>
</li>
</ul>
<p>You can also  pass your custom function with a pair <code>name &#61;&gt; function</code> for instance:</p>
<pre><code class="language-julia">foo&#40;x&#41; &#61; sum&#40;abs.&#40;x&#41;&#41; / length&#40;x&#41;
d &#61; describe&#40;boston, :mean, :median, :foo &#61;&gt; foo&#41;
first&#40;d, 3&#41;</code></pre><pre><code class="plaintext">3×4 DataFrame
 Row │ variable  mean      median   foo
     │ Symbol    Float64   Float64  Float64
─────┼───────────────────────────────────────
   1 │ Crim       3.61352  0.25651   3.61352
   2 │ Zn        11.3636   0.0      11.3636
   3 │ Indus     11.1368   9.69     11.1368</code></pre>
<p>The <code>describe</code> function returns a derived object with one row per feature and one column per required statistic.</p>
<p>Further to <code>StatsBase</code>, <code>Statistics</code> offers a range of useful functions for data analysis.</p>
<pre><code class="language-julia">using Statistics</code></pre>
<h3 id="converting_the_data"><a href="#converting_the_data" class="header-anchor">Converting the data</a></h3>
<p>If you want to get the content of the dataframe as one big matrix, use <code>convert</code>:</p>
<pre><code class="language-julia">mat &#61; convert&#40;Matrix, boston&#41;
mat&#91;1:3, 1:3&#93;</code></pre><pre><code class="plaintext">3×3 Matrix{Float64}:
 0.00632  18.0  2.31
 0.02731   0.0  7.07
 0.02729   0.0  7.07</code></pre>
<h3 id="adding_columns"><a href="#adding_columns" class="header-anchor">Adding columns</a></h3>
<p>Adding a column to a dataframe is very easy:</p>
<pre><code class="language-julia">boston.Crim_x_Zn &#61; boston.Crim .* boston.Zn;</code></pre>
<p>that&#39;s it&#33; Remember also that you can drop columns or make subselections with <code>select</code> and <code>select&#33;</code>.</p>
<h3 id="missing_values"><a href="#missing_values" class="header-anchor">Missing values</a></h3>
<p>Let&#39;s load a dataset with missing values</p>
<pre><code class="language-julia">mao &#61; dataset&#40;&quot;gap&quot;, &quot;mao&quot;&#41;
describe&#40;mao, :nmissing&#41;</code></pre><pre><code class="plaintext">19×2 DataFrame
 Row │ variable  nmissing
     │ Symbol    Int64
─────┼────────────────────
   1 │ ID               0
   2 │ Type             0
   3 │ Gender           0
   4 │ Age            188
   5 │ AAO            296
   6 │ AAD            295
   7 │ UPDRS          301
   8 │ MAOAI2           0
   9 │ AI2Code          0
  10 │ MAOBI2           0
  11 │ BI2Code          0
  12 │ GTBEX3           0
  13 │ BEX3Code         0
  14 │ MAOAVNTR        46
  15 │ VNTRCode        46
  16 │ VNTRCod2        46
  17 │ MAOA31          36
  18 │ MAO31COD        36
  19 │ MAO31CO2        36</code></pre>
<p>Lots of missing values... If  you wanted to compute simple functions on columns, they  may just return <code>missing</code>:</p>
<pre><code class="language-julia">std&#40;mao.Age&#41;</code></pre><pre><code class="plaintext">missing</code></pre>
<p>The <code>skipmissing</code> function can help counter this  easily:</p>
<pre><code class="language-julia">std&#40;skipmissing&#40;mao.Age&#41;&#41;</code></pre><pre><code class="plaintext">11.551715894987558</code></pre>
<h2 id="split-apply-combine"><a href="#split-apply-combine" class="header-anchor">Split-Apply-Combine</a></h2>
<p>This is a shorter version of the <a href="http://juliadata.github.io/DataFrames.jl/latest/man/split_apply_combine/">DataFrames.jl tutorial</a>.</p>
<pre><code class="language-julia">iris &#61; dataset&#40;&quot;datasets&quot;, &quot;iris&quot;&#41;
first&#40;iris, 3&#41;</code></pre><pre><code class="plaintext">3×5 DataFrame
 Row │ SepalLength  SepalWidth  PetalLength  PetalWidth  Species
     │ Float64      Float64     Float64      Float64     Cat…
─────┼───────────────────────────────────────────────────────────
   1 │         5.1         3.5          1.4         0.2  setosa
   2 │         4.9         3.0          1.4         0.2  setosa
   3 │         4.7         3.2          1.3         0.2  setosa</code></pre>
<h3 id="groupby"><a href="#groupby" class="header-anchor"><code>groupby</code></a></h3>
<p>The <code>groupby</code> function allows to form &quot;sub-dataframes&quot; corresponding to groups of rows. This can be very convenient to run specific analyses for specific groups without copying the data.</p>
<p>The basic usage is <code>groupby&#40;df, cols&#41;</code> where <code>cols</code> specifies one or several columns to use for the grouping.</p>
<p>Consider a simple example: in <code>iris</code> there is a <code>Species</code> column with 3 species:</p>
<pre><code class="language-julia">unique&#40;iris.Species&#41;</code></pre><pre><code class="plaintext">3-element Vector{String}:
 "setosa"
 "versicolor"
 "virginica"</code></pre>
<p>We can form views for each of these:</p>
<pre><code class="language-julia">gdf &#61; groupby&#40;iris, :Species&#41;;</code></pre>
<p>The <code>gdf</code> object now corresponds to <strong>views</strong> of the original dataframe for each of the 3 species; the first species is <code>&quot;setosa&quot;</code> with:</p>
<pre><code class="language-julia">subdf_setosa &#61; gdf&#91;1&#93;
describe&#40;subdf_setosa, :min, :mean, :max&#41;</code></pre><pre><code class="plaintext">5×4 DataFrame
 Row │ variable     min     mean    max
     │ Symbol       Any     Union…  Any
─────┼─────────────────────────────────────
   1 │ SepalLength  4.3     5.006   5.8
   2 │ SepalWidth   2.3     3.428   4.4
   3 │ PetalLength  1.0     1.462   1.9
   4 │ PetalWidth   0.1     0.246   0.6
   5 │ Species      setosa          setosa</code></pre>
<p>Note that <code>subdf_setosa</code> is a <code>SubDataFrame</code> meaning that it is just a view of the parent dataframe <code>iris</code>; if you modify that parent dataframe then the sub dataframe is also  modified.</p>
<p>See <code>?groupby</code> for more information.</p>
<h3 id="combine"><a href="#combine" class="header-anchor"><code>combine</code></a></h3>
<p>The <code>combine</code> function allows to derive a new dataframe out of transformations of an existing one. Here&#39;s an example taken from the official doc &#40;see <code>?combine</code>&#41;:</p>
<pre><code class="language-julia">df &#61; DataFrame&#40;a&#61;1:3, b&#61;4:6&#41;
combine&#40;df, :a &#61;&gt; sum, nrow&#41;</code></pre><pre><code class="plaintext">1×2 DataFrame
 Row │ a_sum  nrow
     │ Int64  Int64
─────┼──────────────
   1 │     6      3</code></pre>
<p>what happened here is that the derived DataFrame has two columns obtained respectively by &#40;1&#41; computing the sum of the first column and &#40;2&#41; applying the <code>nrow</code> function on the <code>df</code>.</p>
<p>The transformation can produce one or several values, <code>combine</code> will try to concatenate these columns as it can, for instance:</p>
<pre><code class="language-julia">foo&#40;v&#41; &#61; v&#91;1:2&#93;
combine&#40;df, :a &#61;&gt; maximum, :b &#61;&gt; foo&#41;</code></pre><pre><code class="plaintext">2×2 DataFrame
 Row │ a_maximum  b_foo
     │ Int64      Int64
─────┼──────────────────
   1 │         3      4
   2 │         3      5</code></pre>
<p>here the maximum value of <code>a</code> is copied twice so that the two columns have the same number of rows.</p>
<pre><code class="language-julia">bar&#40;v&#41; &#61; v&#91;end-1:end&#93;
combine&#40;df, :a &#61;&gt; foo, :b &#61;&gt; bar&#41;</code></pre><pre><code class="plaintext">2×2 DataFrame
 Row │ a_foo  b_bar
     │ Int64  Int64
─────┼──────────────
   1 │     1      5
   2 │     2      6</code></pre>
<h3 id="combine_with_groupby"><a href="#combine_with_groupby" class="header-anchor"><code>combine</code> with <code>groupby</code></a></h3>
<p>Combining <code>groupby</code> with <code>combine</code> is very useful. For instance you might want to compute statistics across groups for different variables:</p>
<pre><code class="language-julia">combine&#40;groupby&#40;iris, :Species&#41;, :PetalLength &#61;&gt; mean&#41;</code></pre><pre><code class="plaintext">3×2 DataFrame
 Row │ Species     PetalLength_mean
     │ Cat…        Float64
─────┼──────────────────────────────
   1 │ setosa                 1.462
   2 │ versicolor             4.26
   3 │ virginica              5.552</code></pre>
<p>let&#39;s decompose that:</p>
<ol>
<li><p>the <code>groupby&#40;iris, :Species&#41;</code> creates groups using the <code>:Species</code> column &#40;which has values <code>setosa</code>, <code>versicolor</code>, <code>virginica</code>&#41;</p>
</li>
<li><p>the <code>combine</code> creates a derived dataframe by applying the <code>mean</code> function to the <code>:PetalLength</code> column</p>
</li>
<li><p>since there are three groups, we get one column &#40;mean of <code>PetalLength</code>&#41; and three rows &#40;one per group&#41;.</p>
</li>
</ol>
<p>You can do this for several columns/statistics at the time and give new column names to the results:</p>
<pre><code class="language-julia">gdf &#61; groupby&#40;iris, :Species&#41;
combine&#40;gdf, :PetalLength &#61;&gt; mean &#61;&gt; :MPL, :PetalLength &#61;&gt; std &#61;&gt; :SPL&#41;</code></pre><pre><code class="plaintext">3×3 DataFrame
 Row │ Species     MPL      SPL
     │ Cat…        Float64  Float64
─────┼───────────────────────────────
   1 │ setosa        1.462  0.173664
   2 │ versicolor    4.26   0.469911
   3 │ virginica     5.552  0.551895</code></pre>
<p>so here we assign the names <code>:MPL</code> and <code>:SPL</code> to the derived columns. If you want to apply something on all columns apart from the grouping one, using <code>names</code> and <code>Not</code> comes in handy:</p>
<pre><code class="language-julia">combine&#40;gdf, names&#40;iris, Not&#40;:Species&#41;&#41; .&#61;&gt; std&#41;</code></pre><pre><code class="plaintext">3×5 DataFrame
 Row │ Species     SepalLength_std  SepalWidth_std  PetalLength_std  PetalWidth_std
     │ Cat…        Float64          Float64         Float64          Float64
─────┼──────────────────────────────────────────────────────────────────────────────
   1 │ setosa             0.35249         0.379064         0.173664        0.105386
   2 │ versicolor         0.516171        0.313798         0.469911        0.197753
   3 │ virginica          0.63588         0.322497         0.551895        0.27465</code></pre>
<p>where</p>
<pre><code class="language-julia">names&#40;iris, Not&#40;:Species&#41;&#41;</code></pre><pre><code class="plaintext">4-element Vector{String}:
 "SepalLength"
 "SepalWidth"
 "PetalLength"
 "PetalWidth"</code></pre>
<p>and note the use of <code>.</code> in <code>.&#61;&gt;</code> to indicate that we broadcast the function over each column.</p>

<div class="page-foot">
  <div class="copyright">
    &copy; Thibaut Lienart, Anthony Blaom, Sebastian Vollmer and collaborators. Last modified: July 16, 2020. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>.
  </div>
</div>
</div><!-- CONTENT ENDS HERE -->
      </div> <!-- end of id=main -->
  </div> <!-- end of id=layout -->
  <script src="/libs/pure/ui.min.js"></script>
  
  
      <script src="/libs/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>

  
</body>
</html>
